(globalThis["webpackChunkapp_telos_net"]=globalThis["webpackChunkapp_telos_net"]||[]).push([[437],{69342:(t,e,l)=>{"use strict";l.d(e,{U:()=>o});l(40702);var s=l(33100);const a=new RegExp(/Qm[1-9A-HJ-NP-Za-km-z]{44}(\/.*)?/,"m"),o={data(){return{rules:{accountExists:async t=>!await this.isAccountFree(t.toLowerCase())||this.$t("forms.errors.accountNotExists",{account:t}),accountFormat:t=>/^([a-z]|[1-5]|.){1,12}$/.test(t.toLowerCase())||this.$t("forms.errors.accountFormat"),accountFormatBasic:t=>/^([a-z]|[1-5]){12}$/.test(t.toLowerCase())||this.$t("forms.errors.accountFormatBasic"),accountLength:t=>t.length<=12||this.$t("forms.errors.accountLength"),dateFuture:t=>e=>new Date(e).getTime()>=new Date(t).getTime()||this.$t("forms.errors.dateFuture"),greaterOrEqualThan:t=>e=>e>=t||this.$t("forms.errors.greaterOrEqualThan",{value:t}),minimumOptions:t=>e=>e.length>=t||this.$t("forms.errors.greaterOrEqualThan",{value:t}),isAccountAvailable:async t=>await this.isAccountFree(t.toLowerCase())||this.$t("forms.errors.accountNotAvailable",{account:t}),isInteger:t=>Number.isInteger(parseInt(t))||this.$t("forms.errors.integer"),isToken:t=>t.length>=2&&t.length<=6||this.$t("forms.errors.token"),isTokenDecimals:t=>parseInt(t)>=0&&parseInt(t)<=9||this.$t("forms.errors.tokenDecimals"),positiveInteger:t=>parseInt(t)>0||this.$t("forms.errors.positiveInteger"),isValidIPFShash:t=>t.match(a)||"Invalid IPFS HASH format",required:t=>!!t||this.$t("forms.errors.required")}}},methods:{...(0,s.nv)("accounts",["isAccountFree"]),async validate(t){if(!t)return!0;for await(const e of Object.keys(t))this.$refs[e]&&await this.$refs[e].validate();return Object.keys(t).reduce(((t,e)=>t&&(!this.$refs[e]||!this.$refs[e].hasError)),!0)},resetValidation(t){t&&Object.keys(t).forEach((t=>this.$refs[t]&&this.$refs[t].resetValidation()))}}}},86136:(t,e,l)=>{"use strict";l.r(e),l.d(e,{default:()=>ja});var s=l(59835),a=l(86970);const o={class:"ballots",ref:"ballotsRef"},i={key:0,class:"text-weight-bold",style:{"text-align":"center"}},n={class:"row justify-center q-my-md"};function r(t,e,l,r,u,c){const p=(0,s.up)("welcome-card"),d=(0,s.up)("action-bar"),m=(0,s.up)("ballot-form"),g=(0,s.up)("ballot-list-item"),b=(0,s.up)("q-spinner-dots"),h=(0,s.up)("q-infinite-scroll"),f=(0,s.up)("ballot-view"),w=(0,s.up)("q-dialog"),y=(0,s.up)("q-page");return u.renderComponent?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(y,{key:0},{default:(0,s.w5)((()=>[!c.isNewUser()&&t.isAuthenticated?((0,s.wg)(),(0,s.j4)(p,{key:0})):(0,s.kq)("",!0),(0,s.Wm)(d,{ref:"actionBar",onUpdateTreasury:c.updateTreasury,onUpdateStatuses:c.updateStatuses,onUpdateCategories:c.updateCategories,onChangeDiraction:c.changeDirection,onOpenBallotForm:c.openBallotForm,onChangeSortOption:c.changeSortOption,onUpdateCards:c.updateCards,treasuriesOptions:t.treasuriesOptions,activeFilter:l.activeFilter,election:t.$route.path.indexOf("election")>0},null,8,["onUpdateTreasury","onUpdateStatuses","onUpdateCategories","onChangeDiraction","onOpenBallotForm","onChangeSortOption","onUpdateCards","treasuriesOptions","activeFilter","election"]),(0,s.Wm)(m,{show:u.show,onClose:e[0]||(e[0]=t=>u.show=!1)},null,8,["show"]),(0,s._)("div",o,[(0,s.Wm)(h,{ref:"infiniteScroll",offset:250},{loading:(0,s.w5)((()=>[(0,s._)("div",n,[(0,s.Wm)(b,{color:"primary",size:"40px"})])])),default:(0,s.w5)((()=>[(0,s._)("div",{class:(0,a.C_)(u.isBallotListRowDirection?"row-direction":"column-direction")},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.sortBallots(c.filterBallots(t.ballots),u.sortMode),((t,e)=>((0,s.wg)(),(0,s.j4)(g,{onClick:e=>c.openBallot(t),key:e,ballot:t,displayWinner:c.displayWinner,isBallotOpened:c.isBallotOpened(t),votingHasBegun:c.votingHasBegun(t),getStartTime:c.getStartTime(t),getEndTime:c.getEndTime(t),getLoser:c.getLoser,ballotContentImg:c.ballotContentImg},null,8,["onClick","ballot","displayWinner","isBallotOpened","votingHasBegun","getStartTime","getEndTime","getLoser","ballotContentImg"])))),128))],2),c.sortBallots(c.filterBallots(t.ballots),u.sortMode).length||u.loading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("p",i,"There is no data for the corresponding request"))])),_:1},512)],512),((0,s.wg)(),(0,s.j4)(w,{modelValue:u.showBallot,"onUpdate:modelValue":e[1]||(e[1]=t=>u.showBallot=t),key:t.$route.params.id+u.timeAtMount,"transition-show":"slide-up","transition-hide":"slide-down",onHide:c.closeBallot},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{isBallotOpened:c.isBallotOpened,displayWinner:c.displayWinner,votingHasBegun:c.votingHasBegun,getStartTime:c.getStartTime,getEndTime:c.getEndTime,getLoser:c.getLoser,ballotContentImg:c.ballotContentImg},null,8,["isBallotOpened","displayWinner","votingHasBegun","getStartTime","getEndTime","getLoser","ballotContentImg"])])),_:1},8,["modelValue","onHide"]))])),_:1}))}l(46727);var u=l(33100);const c=(0,s._)("div",{class:"text-h6"},"Create a ballot",-1),p={class:"row"},d={key:0,class:"row"},m={key:0,class:"q-ml-sm"},g={key:1,class:"q-ml-sm"};function b(t,e,l,o,i,n){const r=(0,s.up)("q-card-section"),u=(0,s.up)("q-input"),b=(0,s.up)("q-select"),h=(0,s.up)("q-icon"),f=(0,s.up)("q-file"),w=(0,s.up)("q-radio"),y=(0,s.up)("q-date"),v=(0,s.up)("q-popup-proxy"),_=(0,s.up)("q-time"),k=(0,s.up)("q-btn"),S=(0,s.up)("q-card-actions"),B=(0,s.up)("q-card"),W=(0,s.up)("q-dialog"),T=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.j4)(W,{modelValue:l.show,"onUpdate:modelValue":e[22]||(e[22]=t=>l.show=t),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{flat:"",bordered:"",style:{width:"400px","max-width":"80vw"}},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"bg-primary text-white"},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,{ref:"title",modelValue:i.form.title,"onUpdate:modelValue":e[0]||(e[0]=t=>i.form.title=t),label:"Title",rules:[t.rules.required]},null,8,["modelValue","rules"]),(0,s.Wm)(b,{ref:"category",modelValue:i.form.category,"onUpdate:modelValue":e[1]||(e[1]=t=>i.form.category=t),label:"Category",options:i.categoryOptions,"emit-value":"","map-options":"",rules:[t.rules.required]},null,8,["modelValue","options","rules"]),(0,s.Wm)(b,{ref:"votingMethod",modelValue:i.form.votingMethod,"onUpdate:modelValue":e[2]||(e[2]=t=>i.form.votingMethod=t),label:"Voting method",options:i.votingMethodOptions,"emit-value":"","map-options":"",rules:[t.rules.required]},null,8,["modelValue","options","rules"]),(0,s.Wm)(u,{ref:"description",modelValue:i.form.description,"onUpdate:modelValue":e[3]||(e[3]=t=>i.form.description=t),label:"Description",type:"textarea",rules:[t.rules.required]},null,8,["modelValue","rules"]),(0,s.Wm)(u,{class:"q-mb-md",ref:"img",modelValue:i.form.imageUrl,"onUpdate:modelValue":e[4]||(e[4]=t=>i.form.imageUrl=t),label:"Image URL",placeholder:"https://...",hint:"Upload an image and paste the url here to include it in your ballot.",rules:[t.rules.required]},null,8,["modelValue","rules"]),(0,s.Wm)(f,{modelValue:i.file,"onUpdate:modelValue":e[5]||(e[5]=t=>i.file=t),label:"Upload PDF"},{prepend:(0,s.w5)((()=>[(0,s.Wm)(h,{name:"attach_file"})])),_:1},8,["modelValue"]),(0,s.Wm)(b,{ref:"treasurySymbol",modelValue:i.form.treasurySymbol,"onUpdate:modelValue":e[6]||(e[6]=t=>i.form.treasurySymbol=t),label:"Treasury",options:n.getTreasurySymbols,rules:[t.rules.required]},null,8,["modelValue","options","rules"]),(0,s.Wm)(b,{ref:"initialOptions",modelValue:i.form.initialOptions,"onUpdate:modelValue":e[7]||(e[7]=t=>i.form.initialOptions=t),label:"Options","use-input":"","use-chips":"",multiple:"","hide-dropdown-icon":"","input-debounce":"0",onNewValue:n.addBallotOption,rules:[t.rules.required,t.rules.minimumOptions(2)]},null,8,["modelValue","onNewValue","rules"]),(0,s._)("div",p,[(0,s.Wm)(u,{class:"col-6",type:"number",ref:"minOptions",modelValue:i.form.minOptions,"onUpdate:modelValue":e[8]||(e[8]=t=>i.form.minOptions=t),label:"Min options",rules:[t.rules.required,t.rules.integer,t.rules.positiveInteger]},null,8,["modelValue","rules"]),(0,s.Wm)(u,{class:"col-6",type:"number",ref:"maxOptions",modelValue:i.form.maxOptions,"onUpdate:modelValue":e[9]||(e[9]=t=>i.form.maxOptions=t),label:"Max options",rules:[t.rules.required,t.rules.integer,t.rules.positiveInteger,t.rules.greaterOrEqualThan(i.form.minOptions),t.rules.greaterOrEqualThan(2)]},null,8,["modelValue","rules"])]),n.configEnable?((0,s.wg)(),(0,s.iD)("div",d,[(0,s.Wm)(w,{modelValue:i.form.config,"onUpdate:modelValue":e[10]||(e[10]=t=>i.form.config=t),label:"Stakeble",val:"votestake"},null,8,["modelValue"]),(0,s.Wm)(w,{modelValue:i.form.config,"onUpdate:modelValue":e[11]||(e[11]=t=>i.form.config=t),label:"Liquid",val:"voteliquid"},null,8,["modelValue"]),(0,s.Wm)(w,{modelValue:i.form.config,"onUpdate:modelValue":e[12]||(e[12]=t=>i.form.config=t),label:"Both",val:"both"},null,8,["modelValue"])])):(0,s.kq)("",!0),(0,s.Wm)(u,{ref:"endDate",modelValue:i.form.endDate,"onUpdate:modelValue":e[17]||(e[17]=t=>i.form.endDate=t),label:"End date",rules:[t.rules.required,t.rules.dateFuture(Date.now())]},{append:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"cursor-pointer",name:"event"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{modelValue:i.form.endDate,"onUpdate:modelValue":e[13]||(e[13]=t=>i.form.endDate=t),onInput:e[14]||(e[14]=()=>t.$refs.qDateProxy.hide()),mask:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])])),_:1},512)])),_:1}),(0,s.Wm)(h,{class:"cursor-pointer",name:"access_time"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{modelValue:i.form.endDate,"onUpdate:modelValue":e[15]||(e[15]=t=>i.form.endDate=t),onInput:e[16]||(e[16]=()=>t.$refs.qDateProxy.hide()),mask:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue","rules"])])),_:1}),(0,s.Wm)(S,{align:"right"},{default:(0,s.w5)((()=>[(0,s.Wm)(k,{flat:"",label:t.$t("common.buttons.cancel"),onClick:e[18]||(e[18]=t=>n.onCancel())},null,8,["label"]),(0,s.Wm)(k,{color:"primary",label:t.$t("common.buttons.create"),loading:i.submitting,onClick:e[19]||(e[19]=t=>n.openConfirmation())},null,8,["label","loading"])])),_:1}),(0,s.Wm)(W,{modelValue:i.prompt,"onUpdate:modelValue":e[21]||(e[21]=t=>i.prompt=t),persistent:""},{default:(0,s.w5)((()=>[(0,s.Wm)(B,{style:{"min-width":"350px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"row items-center"},{default:(0,s.w5)((()=>[n.available?((0,s.wg)(),(0,s.iD)("span",m,"There will be a "+(0,a.zw)(n.fee)+" fee for creating a ballot.",1)):((0,s.wg)(),(0,s.iD)("span",g,(0,a.zw)("Insufficient balance to create a ballot."),1))])),_:1}),(0,s.Wm)(S,{class:"text-primary",align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(k,{flat:"",label:"Cancel"},null,512),[[T]]),n.available?(0,s.wy)(((0,s.wg)(),(0,s.j4)(k,{key:0,flat:"",label:"Accept",onClick:e[20]||(e[20]=t=>n.onAddBallot())},null,512)),[[T]]):(0,s.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["modelValue"])}l(18964);var h=l(69342),f=l(93658),w=l(17779);const y={name:"BallotForm",mixins:[h.U],props:{show:{type:Boolean,required:!0}},emits:["close"],data(){return{form:{title:null,category:"poll",description:null,imageUrl:null,IPFSString:null,treasurySymbol:null,votingMethod:"1token1vote",maxOptions:1,minOptions:1,initialOptions:[],endDate:null,config:"votestake"},prompt:!1,userBalance:null,votingMethodOptions:[{value:"1acct1vote",label:"One vote per account"},{value:"1tokennvote",label:"All tokens to each vote"},{value:"1token1vote",label:"All tokens split to each vote"},{value:"1tsquare1v",label:"One token equals one square vote"},{value:"quadratic",label:"Quadratic"}],categoryOptions:[{value:"election",label:"Election"},{value:"poll",label:"Poll"},{value:"referendum",label:"Referendum"}],submitting:!1,file:null,cid:null,fee:null}},computed:{...(0,u.Se)("trails",["treasuries","userTreasury","ballotFees"]),...(0,u.Se)("accounts",["account"]),getTreasurySymbols(){if(this.userTreasury){const t=this.userTreasury.map((t=>({symbol:t.delegated.replace(/[^a-zA-Z]/gi,"")})));return this.treasuries.filter((e=>t.some((t=>e.symbol===t.symbol)))).map((t=>({label:t.title?`${t.title} (${t.supply})`:t.supply,value:t.supply,symbol:t.supply.replace(/[^a-zA-Z]/gi,"")})))}return null},isStakeable(){var t;let e=null===(t=this.treasuries.find((t=>{var e;return("public"===t.access||t.manager===this.account)&&t.symbol===(null===(e=this.form.treasurySymbol)||void 0===e?void 0:e.symbol)})))||void 0===t?void 0:t.settings;return e?e.find((t=>"stakeable"===t.key)).value:null},configEnable(){var t;return"VOTE"!==(null===(t=this.form.treasurySymbol)||void 0===t?void 0:t.symbol)&&this.isStakeable},available(){if(w.log("BallotForm.computed.available -> this.userBalance: ",this.userBalance),this.userBalance){const t=this.onlyNumbers(this.ballotFees.value);return this.userBalance>=t}return null},fee(){return this.ballotFees?this.ballotFees.value:0}},methods:{...(0,u.nv)("trails",["addBallot","fetchTreasuriesForUser","fetchFees"]),async onAddBallot(){this.submitting=!0;const t=await this.addBallot(this.createBallotObject());this.submitting=!1,t&&(this.$emit("update:show",!1),this.resetBallot())},async openConfirmation(){this.resetValidation(this.form),await this.validate(this.form)&&(this.prompt=!0)},resetBallot(){this.form={title:null,category:null,description:null,imageUrl:null,treasurySymbol:null,votingMethod:"1token1vote",initialOptions:[],endDate:null,IPFSString:null},this.file=null,this.cid=null},onCancel(){this.resetBallot(),this.$emit("close")},addBallotOption(t,e){e(t.toLowerCase(),"add-unique")},createBallotObject(){return{title:this.form.title,category:this.form.category,description:this.form.IPFSString&&""!==this.form.IPFSString.trim()?`${this.form.description} ${this.form.IPFSString}`:this.form.description,content:this.form.imageUrl?`{"imageUrl":"${this.form.imageUrl}"}`:"",treasurySymbol:this.form.treasurySymbol,votingMethod:this.form.votingMethod,maxOptions:this.form.maxOptions,minOptions:this.form.minOptions,initialOptions:this.form.initialOptions,endDate:this.form.endDate,config:this.form.config,settings:this.isStakeable}},async convertToIPFS(t){try{const e=await f.Ue();this.cid=await e.add(t)}catch(e){if("ERR_LOCK_EXISTS"==e.code)return;w.error(e)}},async updateUserBalance(){const t=await this.$store.$api.getAccount(this.account);this.userBalance=this.onlyNumbers(t.core_liquid_balance)}},watch:{file:function(){this.convertToIPFS(this.file)},account:async function(t){this.fetchTreasuriesForUser(t),this.updateUserBalance()},cid:function(){this.cid?this.form.IPFSString=this.cid.path:this.form.IPFSString=null}},mounted(){this.fetchFees(),this.updateUserBalance(),this.fetchTreasuriesForUser(this.account)}};var v=l(11639),_=l(32074),k=l(44458),S=l(63190),B=l(13119),W=l(32259),T=l(33837),O=l(22857),x=l(11480),C=l(52765),D=l(14351),V=l(86770),q=l(11821),$=l(68879),F=l(62146),M=l(69984),U=l.n(M);const z=(0,v.Z)(y,[["render",b]]),Z=z;U()(y,"components",{QDialog:_.Z,QCard:k.Z,QCardSection:S.Z,QInput:B.Z,QSelect:W.Z,QFile:T.Z,QIcon:O.Z,QRadio:x.Z,QPopupProxy:C.Z,QDate:D.Z,QTime:V.Z,QCardActions:q.Z,QBtn:$.Z}),U()(y,"directives",{ClosePopup:F.Z});const L=["src"],R=["src"],A=["src"],P=["src"],Q={class:"text-section row ballot-card-title-wrapper"},I={class:"ballot-card-title"},N={class:"ballot-card-sub-title-wrapper row"},H={class:"sub-title-card-img-wrapper"},G=(0,s._)("span",{class:"opacity04"},"By ",-1),E={class:"sub-title-group-wrapper"},j=(0,s._)("span",{class:"opacity04"},"in ",-1),Y={class:"opacity06"},J=(0,s._)("span",{class:"opacity04"},"By ",-1),K=(0,s._)("span",{class:"opacity04"}," in ",-1),X={class:"opacity06"},tt={class:"text-section-row"},et={class:"statics-section-item section-item-btn"},lt={class:"statics-section-wrapper-scroll"},st={class:"statics-section-wrapper"},at={key:0,class:"statics-section-item"},ot={class:"text-weight-bold"},it={class:"opacity06"},nt={key:1,class:"statics-section-item"},rt=(0,s._)("div",{class:"bar-custom-separator text-section-separator"},null,-1),ut={class:"statics-section-item"},ct={class:"text-weight-bold"},pt=(0,s._)("span",{class:"opacity06"}," voted",-1),dt=(0,s._)("div",{class:"bar-custom-separator text-section-separator"},null,-1),mt={class:"statics-section-item"},gt={class:"text-weight-bold"},bt={class:"opacity06"},ht=(0,s._)("span",{class:"opacity06"},"tokens",-1),ft={class:"text-section column"},wt={key:0,class:"statics-section-item"},yt={class:"text-weight-bold"},vt={class:"opacity06"},_t={key:1,class:"statics-section-item"},kt={class:"statics-section-item"},St={class:"text-weight-bold"},Bt=(0,s._)("span",{class:"opacity06"}," voted",-1),Wt={class:"statics-section-item"},Tt={class:"text-weight-bold"},Ot={class:"opacity06"},xt=(0,s._)("span",{class:"opacity06"},"tokens",-1);function Ct(t,e,l,o,i,n){const r=(0,s.up)("q-icon"),u=(0,s.up)("q-img"),c=(0,s.up)("q-card-section"),p=(0,s.up)("ballot-chip"),d=(0,s.up)("q-separator"),m=(0,s.up)("ballot-status"),g=(0,s.up)("btn"),b=(0,s.up)("q-card");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(b,{class:(0,a.C_)(["poll-item","voting"===l.ballot.status&&l.isBallotOpened?"":"poll-ended"])},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"card-img-wrapper"},{default:(0,s.w5)((()=>[l.ballotContentImg(l.ballot)?((0,s.wg)(),(0,s.j4)(u,{key:0,class:"poll-item-image-wrapper",src:l.ballotContentImg(l.ballot)},{error:(0,s.w5)((()=>[(0,s.Wm)(r,{size:"lg",name:"far fa-image"})])),_:1},8,["src"])):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[l.isBallotOpened&&"voting"===l.ballot.status?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("img",{class:"bgr-icon1",src:`statics/app-icons/${l.ballot.category.toLowerCase()}-bgr-icon1.png`},null,8,L),(0,s._)("img",{class:"bgr-icon2",src:`statics/app-icons/${l.ballot.category.toLowerCase()}-bgr-icon2.png`},null,8,R)],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s._)("img",{class:"bgr-icon1",src:"statics/app-icons/inactive-bgr-icon1.png"},null,8,A),(0,s._)("img",{class:"bgr-icon2",src:"statics/app-icons/inactive-bgr-icon2.png"},null,8,P)],64))],64))])),_:1}),(0,s.Wm)(p,{class:"absolute-top-left",type:l.ballot.category,isBallotOpened:l.isBallotOpened},null,8,["type","isBallotOpened"]),(0,s.Wm)(d,{class:"card-separator-vertical",vertical:"",inset:""}),(0,s.Wm)(m,{ballot:l.ballot,isBallotOpened:l.isBallotOpened,getEndTime:l.getEndTime,votingHasBegun:l.votingHasBegun,getStartTime:l.getStartTime},null,8,["ballot","isBallotOpened","getEndTime","votingHasBegun","getStartTime"]),(0,s.Wm)(c,{class:"q-pb-none cursor-pointer title-section"},{default:(0,s.w5)((()=>[(0,s._)("div",Q,[(0,s._)("span",I,(0,a.zw)(l.ballot.title||"Untitled Ballot"),1)]),(0,s._)("div",N,[l.ballot.treasury.icon&&""!==l.ballot.treasury.icon&&"null"!==l.ballot.treasury.icon?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",H,[(0,s.Wm)(u,{src:l.ballot.treasury.icon},null,8,["src"])]),(0,s._)("div",null,[(0,s._)("div",null,[G,(0,s._)("a",{class:"link cursor-pointer",onClick:e[0]||(e[0]=t=>n.openUrl(l.ballot.publisher))},(0,a.zw)(l.ballot.publisher),1)]),(0,s._)("div",E,[j,(0,s._)("span",Y,(0,a.zw)(l.ballot.treasury.title||"No treasury"),1)])])],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[J,(0,s._)("a",{class:"link cursor-pointer",onClick:e[1]||(e[1]=t=>n.openUrl(l.ballot.publisher))},(0,a.zw)(l.ballot.publisher),1),K,(0,s._)("span",X,(0,a.zw)(l.ballot.treasury.title||"No treasury"),1)],64))]),(0,s._)("div",tt,[(0,s._)("div",et,[(0,s.Wm)(g,{labelText:l.isBallotOpened&&"voting"===l.ballot.status?"View proposal & vote":"View proposal",btnWidth:"220",fontSize:"16",hoverBlue:""},null,8,["labelText"])]),(0,s._)("div",lt,[(0,s._)("div",st,[l.ballot.total_voters>0?((0,s.wg)(),(0,s.iD)("div",at,[(0,s._)("span",ot,(0,a.zw)(n.getPercentofTotal(n.getWinner))+"% ",1),(0,s._)("span",it,(0,a.zw)(n.getWinner.key.toUpperCase())+" "+(0,a.zw)(l.getLoser.key?` lead over ${l.getLoser.key.toUpperCase()}`:" lead over others"),1)])):((0,s.wg)(),(0,s.iD)("div",nt,[(0,s._)("span",null,(0,a.zw)(n.getWinner),1)])),rt,(0,s._)("div",ut,[(0,s._)("span",ct,(0,a.zw)(`${l.ballot.total_voters} Accounts`),1),pt]),dt,(0,s._)("div",mt,[(0,s._)("span",gt,(0,a.zw)(l.ballot.total_raw_weight.split(" ")[0].split(".")[0])+" ",1),(0,s._)("span",bt,(0,a.zw)(l.ballot.total_raw_weight.split(" ")[1])+" ",1),ht])])])])])),_:1}),(0,s.Wm)(c,{class:"q-pb-none cursor-pointer statics-section"},{default:(0,s.w5)((()=>[(0,s._)("div",ft,[l.ballot.total_voters>0?((0,s.wg)(),(0,s.iD)("div",wt,[(0,s._)("span",yt,(0,a.zw)(n.getPercentofTotal(n.getWinner))+"% ",1),(0,s._)("span",vt,(0,a.zw)(n.getWinner.key.toUpperCase())+" "+(0,a.zw)(l.getLoser.key?` lead over ${l.getLoser.key.toUpperCase()}`:" lead over others"),1)])):((0,s.wg)(),(0,s.iD)("div",_t,[(0,s._)("span",null,(0,a.zw)(n.getWinner),1)])),(0,s._)("div",kt,[(0,s._)("span",St,(0,a.zw)(`${l.ballot.total_voters} Accounts`),1),Bt]),(0,s._)("div",Wt,[(0,s._)("span",Tt,(0,a.zw)(l.ballot.total_raw_weight.split(" ")[0].split(".")[0])+" ",1),(0,s._)("span",Ot,(0,a.zw)(l.ballot.total_raw_weight.split(" ")[1])+" ",1),xt])])])),_:1}),(0,s.Wm)(c,{class:"row justify-center btn-section"},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{labelText:l.isBallotOpened&&"voting"===l.ballot.status&&t.isAuthenticated?"View proposal & vote":"View proposal",btnWidth:"332",fontSize:"16",hoverBlue:""},null,8,["labelText"])])),_:1})])),_:1},8,["class"])])}const Dt={class:"left-tag cursor-default"},Vt=(0,s._)("div",{class:"status-frame-title"},"Time left",-1),qt=(0,s._)("div",{class:"status-frame-title"},"Voting begins in",-1),$t=(0,s._)("div",{class:"status-frame-title"},"Status",-1),Ft={key:0},Mt={key:1},Ut={class:"status-frame-title time"};function zt(t,e,l,o,i,n){const r=(0,s.up)("countdown");return(0,s.wg)(),(0,s.iD)("div",Dt,["voting"===l.ballot.status&&l.isBallotOpened?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[Vt,(0,s.Wm)(r,{endtime:l.getEndTime},null,8,["endtime"])],64)):"voting"!==l.ballot.status||l.votingHasBegun?((0,s.wg)(),(0,s.iD)(s.HY,{key:2},[$t,"setup"===l.ballot.status?((0,s.wg)(),(0,s.iD)("span",Ft,"Setup")):((0,s.wg)(),(0,s.iD)("span",Mt,"Proposal ended"))],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[qt,(0,s.Wm)(r,{endtime:l.getStartTime},null,8,["endtime"])],64)),(0,s._)("div",Ut,(0,a.zw)(Date.now()>l.getEndTime?"Ended":"Ends"),1),(0,s._)("div",null,(0,a.zw)(i.moment(l.getEndTime).format("MMMM Do YYYY")),1)])}var Zt=l(61957);const Lt={class:"row"},Rt=(0,s._)("span",null," days",-1),At=(0,s._)("span",{class:"opacity04"}," : ",-1),Pt=(0,s._)("span",null,"h",-1),Qt=(0,s._)("span",{class:"opacity04"}," : ",-1),It=(0,s._)("span",null,"m",-1);function Nt(t,e,l,o,i,n){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.wy)((0,s._)("div",Lt,[(0,s._)("span",null,(0,a.zw)(i.days),1),Rt,At,(0,s._)("span",null,(0,a.zw)(i.hours),1),Pt,Qt,(0,s._)("span",null,(0,a.zw)(i.minutes),1),It],512),[[Zt.F8,"expired"!==i.statusType]])])}const Ht={name:"CountdownBlock",props:["endtime"],data(){return{timer:"",wordString:{day:"Day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",expired:"Event has been expired.",running:"Till the end of event.",upcoming:"Till start of event.",status:{expired:"Expired",running:"Running",upcoming:"Future"}},start:"",end:"",interval:"",days:"",minutes:"",hours:"",seconds:"",message:"",statusType:"",statusText:""}},mounted(){this.start=(new Date).getTime(),this.end=new Date(this.endtime).getTime(),this.timerCount(this.start,this.end),this.interval=setInterval((()=>{this.timerCount(this.start,this.end)}),1e3)},methods:{timerCount(t,e){const l=(new Date).getTime();let s=t-l,a=e-l;s<0&&a<0?(this.message=this.wordString.expired,this.statusType="expired",this.statusText=this.wordString.status.expired,clearInterval(this.interval)):s<0&&a>0?(this.calcTime(a),this.message=this.wordString.running,this.statusType="running",this.statusText=this.wordString.status.running):s>0&&a>0&&(this.calcTime(s),this.message=this.wordString.upcoming,this.statusType="upcoming",this.statusText=this.wordString.status.upcoming)},pad(t){return t<10?"0"+t:t},calcTime(t){this.days=this.pad(Math.floor(t/864e5)),this.hours=this.pad(Math.floor(t%864e5/36e5)),this.minutes=this.pad(Math.floor(t%36e5/6e4)),this.seconds=this.pad(Math.floor(t%6e4/1e3))}}},Gt=(0,v.Z)(Ht,[["render",Nt]]),Et=Gt;var jt=l(43878),Yt=l.n(jt);const Jt={name:"BallotStatus",components:{Countdown:Et},data(){return{moment:Yt()}},props:{ballot:{type:Object,required:!0},isBallotOpened:{type:Boolean,required:!0},votingHasBegun:{type:Boolean,required:!0},getStartTime:{type:Number,required:!0},getEndTime:{type:Number,required:!0}}},Kt=(0,v.Z)(Jt,[["render",zt]]),Xt=Kt,te=["src"],ee=["src"],le={class:"type-text"};function se(t,e,l,o,i,n){const r=(0,s.up)("q-avatar"),u=(0,s.up)("q-chip");return(0,s.wg)(),(0,s.j4)(u,{class:(0,a.C_)(["capitalize no-margin text-weight-bold ballot-type",`${l.type}-chip`]),square:"","text-color":"white"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[l.isBallotOpened?((0,s.wg)(),(0,s.iD)("img",{key:0,class:"poll-icon",src:`statics/app-icons/${l.type.toLowerCase()}-icon.svg`},null,8,te)):((0,s.wg)(),(0,s.iD)("img",{key:1,class:"poll-icon",src:`statics/app-icons/${l.type.toLowerCase()}-icon-black.svg`},null,8,ee))])),_:1}),(0,s._)("span",le,(0,a.zw)(n.ucFirst(l.type)),1)])),_:1},8,["class"])}const ae={name:"BallotChip",props:["type","isBallotOpened"],data(){return{}},methods:{ucFirst(t){return t?t[0].toUpperCase()+t.slice(1):t}}};var oe=l(57691),ie=l(61357);const ne=(0,v.Z)(ae,[["render",se]]),re=ne;U()(ae,"components",{QChip:oe.Z,QAvatar:ie.Z,QCard:k.Z});var ue=l(25247),ce=l(17779);const pe={name:"BallotListItem",components:{BallotStatus:Xt,BallotChip:re,Btn:ue.Z},props:{ballot:{type:Object,required:!0},displayWinner:{type:Function,required:!0},isBallotOpened:{type:Boolean,required:!0},votingHasBegun:{type:Boolean,required:!0},getStartTime:{type:Number,required:!0},getEndTime:{type:Number,required:!0},getLoser:{type:Function,required:!0},ballotContentImg:{type:Function,required:!0}},data(){return{voting:!1,votes:[]}},computed:{...(0,u.Se)("accounts",["isAuthenticated"]),getWinner(){if(!this.ballot.total_voters)return"No votes";let t,e=-1;return this.ballot.options.forEach(((l,s)=>{parseFloat(l.value)>e&&(e=parseFloat(l.value),t=s)})),this.ballot.options[t]}},methods:{...(0,u.nv)("trails",["castVote"]),openUrl(t){window.open(`https://explorer-test.telos.net/account/${t}`)},log(t,e){ce.log(t,e)},getPercentofTotal(t){const e=Number(t.value.split(" ")[0])/Number(this.ballot.total_raw_weight.split(" ")[0])*100;return this.trunc(e,2)},async onCastVote({options:t,option:e,ballotName:l}){this.voting=!0,await this.castVote({ballotName:l,options:t||[e]}),this.voting=!1,this.votes=[]}}};var de=l(70335),me=l(50926),ge=l(86870);const be=(0,v.Z)(pe,[["render",Ct]]),he=be;U()(pe,"components",{QCard:k.Z,QCardSection:S.Z,QImg:de.Z,QIcon:O.Z,QSeparator:me.Z,QBtn:$.Z,QInfiniteScroll:ge.Z});l(40702);const fe={key:0,class:"col-xs col-sm-auto popup-left-col-wrapper",style:{"min-width":"268px"}},we=(0,s._)("img",{class:"poll-icon",src:"statics/app-icons/back.svg"},null,-1),ye=(0,s._)("span",null,"Go Back",-1),ve=[we,ye],_e={class:"text-weight-bold variant-name"},ke={class:"text-weight-bold"},Se={key:1,class:"col-xs col-sm-auto popup-left-col-wrapper",style:{"min-width":"240px"}},Be={class:"card-img-wrapper"},We=["src"],Te=["src"],Oe=["src"],xe=["src"],Ce={class:"options-wrapper"},De={class:"row option-item"},Ve={class:"checkbox-text row space-between"},qe={key:0},$e={key:0,class:"linear-progress"},Fe={class:"text-section column"},Me={key:0},Ue=(0,s._)("span",{class:"statistics-title"},"Most voted",-1),ze=[Ue],Ze={key:0,class:"statistics-body"},Le={class:"text-weight-bold"},Re={class:"text-weight-bold"},Ae={key:1},Pe=(0,s._)("span",{class:"statistics-title"},"Number of accounts",-1),Qe={class:"text-weight-bold"},Ie=(0,s._)("div",{class:"poll-icon details"},null,-1),Ne={key:2,class:"statics-section-item"},He=(0,s._)("div",null,[(0,s._)("span",{class:"statistics-title"},"Number of tokens")],-1),Ge={class:"statistics-body"},Ee={class:"text-weight-bold"},je={class:"text-weight-bold"},Ye={key:3},Je=(0,s._)("span",{class:"statistics-title"},"Request amount",-1),Ke=[Je],Xe={key:4,class:"statistics-body"},tl={class:"text-weight-bold"},el={class:"col-xs-12 col-sm popup-right-col-wrapper"},ll={class:"text-section row ballot-card-title-wrapper"},sl={class:"ballot-card-title"},al={class:"ballot-card-sub-title-wrapper row"},ol={class:"sub-title-card-img-wrapper"},il=(0,s._)("span",{class:"opacity04"},"By ",-1),nl={class:"sub-title-group-wrapper"},rl=(0,s._)("span",{class:"opacity04"},"in ",-1),ul={class:"opacity06"},cl=(0,s._)("span",{class:"opacity04"},"By ",-1),pl=(0,s._)("span",{class:"opacity04"}," in ",-1),dl={class:"opacity06"},ml={class:"description-section"},gl=["innerHTML"],bl={key:0,class:"q-pb-md ballot-content-carousel"},hl={key:0,class:"absolute-bottom custom-caption"},fl={class:"caption-text"},wl=["src"],yl={key:2,class:"text-center"},vl=(0,s._)("img",{src:"/statics/app-icons/no-pdf.svg",style:{width:"60px"}},null,-1),_l=(0,s._)("p",{class:"text-caption",style:{color:"#a1c1ff"}},"No PDF found",-1),kl=[vl,_l],Sl={class:"options-wrapper"},Bl={class:"row option-item"},Wl={class:"checkbox-text row space-between"},Tl={key:0},Ol={key:0,class:"linear-progress"},xl={class:"text-section column"},Cl={key:0,class:"statics-section-item"},Dl={class:"text-weight-bold"},Vl={class:"opacity06"},ql={key:1,class:"statics-section-item"},$l={class:"statics-section-item"},Fl={class:"text-weight-bold"},Ml=(0,s._)("span",{class:"opacity06"}," voted",-1),Ul={class:"statics-section-item"},zl={class:"text-weight-bold"},Zl={class:"opacity06"},Ll=(0,s._)("span",{class:"opacity06"},"tokens",-1),Rl={key:2,class:"statics-section-item"},Al={class:"text-weight-bold"},Pl={class:"opacity06"},Ql=(0,s._)("div",null,"Go back",-1),Il=(0,s.Uk)("You have to be logged in to vote. If you don't have account please register");function Nl(t,e,l,o,i,n){const r=(0,s.up)("q-card-section"),u=(0,s.up)("q-card"),c=(0,s.up)("q-icon"),p=(0,s.up)("q-img"),d=(0,s.up)("ballot-chip"),m=(0,s.up)("ballot-status"),g=(0,s.up)("q-checkbox"),b=(0,s.up)("q-item-section"),h=(0,s.up)("q-linear-progress"),f=(0,s.up)("q-item"),w=(0,s.up)("btn"),y=(0,s.up)("q-list"),v=(0,s.up)("q-btn"),_=(0,s.up)("q-separator"),k=(0,s.up)("q-carousel-slide"),S=(0,s.up)("q-carousel-control"),B=(0,s.up)("q-carousel"),W=(0,s.up)("q-card-actions"),T=(0,s.up)("q-dialog"),O=(0,s.up)("q-spinner"),x=(0,s.up)("q-inner-loading"),C=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",{class:"row bg-white justify-between popup-wrapper",onScroll:e[14]||(e[14]=(...t)=>n.updatePopupScroll&&n.updatePopupScroll(...t))},[!i.loading&&t.ballot?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[i.showDetails?((0,s.wg)(),(0,s.iD)("div",fe,[(0,s.Wm)(u,{class:(0,a.C_)("voting"===t.ballot.status&&l.isBallotOpened(t.ballot)?"":"view-poll-ended"),id:"ballot-card",flat:"",square:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"header-nav"},{default:(0,s.w5)((()=>[(0,s._)("div",{onClick:e[0]||(e[0]=t=>i.showDetails=!1)},ve)])),_:1}),(0,s.Wm)(r,{class:"body-info"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.getVariants,(e=>((0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",_e,(0,a.zw)(e.key),1),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.getVoters(e.key),((l,o)=>((0,s.wg)(),(0,s.iD)("div",{class:"list-voters",key:o},[(0,s._)("span",null,(0,a.zw)(l.voter),1),(0,s._)("span",ke,(0,a.zw)(t.getPercentOfNumber(l.value,e.value)),1)])))),128))])))),256))])),_:1})])),_:1},8,["class"])])):((0,s.wg)(),(0,s.iD)("div",Se,[(0,s.Wm)(u,{class:(0,a.C_)(["popup-left-col poll-item","voting"===t.ballot.status&&l.isBallotOpened(t.ballot)?"":"view-poll-ended"]),id:"ballot-card",flat:"",square:"",bordered:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"card-img-section"},{default:(0,s.w5)((()=>[(0,s._)("div",Be,[l.ballotContentImg(t.ballot)?((0,s.wg)(),(0,s.j4)(p,{key:0,class:"poll-item-image-wrapper",src:l.ballotContentImg(t.ballot)},{error:(0,s.w5)((()=>[(0,s.Wm)(c,{size:"lg",name:"far fa-image"})])),_:1},8,["src"])):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[l.isBallotOpened(t.ballot)&&"voting"===t.ballot.status?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("img",{class:"bgr-icon1",src:`statics/app-icons/${t.ballot.category.toLowerCase()}-bgr-icon1.png`},null,8,We),(0,s._)("img",{class:"bgr-icon2",src:`statics/app-icons/${t.ballot.category.toLowerCase()}-bgr-icon2.png`},null,8,Te)],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[(0,s._)("img",{class:"bgr-icon1",src:"statics/app-icons/inactive-bgr-icon1.png"},null,8,Oe),(0,s._)("img",{class:"bgr-icon2",src:"statics/app-icons/inactive-bgr-icon2.png"},null,8,xe)],64))],64)),(0,s.Wm)(d,{class:"absolute-top-left",type:t.ballot.category,isBallotOpened:l.isBallotOpened(t.ballot)},null,8,["type","isBallotOpened"]),(0,s.Wm)(m,{ballot:t.ballot,isBallotOpened:l.isBallotOpened(t.ballot),getEndTime:l.getEndTime(t.ballot),votingHasBegun:l.votingHasBegun(t.ballot),getStartTime:l.getStartTime(t.ballot)},null,8,["ballot","isBallotOpened","getEndTime","votingHasBegun","getStartTime"])]),(0,s.Wm)(y,{class:"options-list list-620",dense:""},{default:(0,s.w5)((()=>[(0,s._)("div",Ce,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.ballot.options,(o=>((0,s.wg)(),(0,s.j4)(f,{class:(0,a.C_)(["ballot-view-option no-padding capitalize column",l.displayWinner(t.ballot)?l.displayWinner(t.ballot)===o.key?"option-winner":"":"option-clear"]),key:o.key},{default:(0,s.w5)((()=>[(0,s._)("div",De,[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,{size:"sm",modelValue:i.votes,"onUpdate:modelValue":e[1]||(e[1]=t=>i.votes=t),disable:"cancelled"!==t.ballot.status&&!l.isBallotOpened,"keep-color":"",class:(0,a.C_)(l.displayWinner(t.ballot)&&l.displayWinner(t.ballot)===o.key?"visible-checkbox":""),color:"$primary",val:o.key,onClick:t=>n.toggleOption(o.key)},{default:(0,s.w5)((()=>[(0,s._)("div",Ve,[(0,s._)("div",null,(0,a.zw)(o.key),1),n.getPartOfTotal(o)?((0,s.wg)(),(0,s.iD)("div",qe,(0,a.zw)(n.getPartOfTotalPercent(o))+"% ",1)):(0,s.kq)("",!0)])])),_:2},1032,["modelValue","disable","class","val","onClick"])])),_:2},1024)]),l.displayWinner(t.ballot)?((0,s.wg)(),(0,s.iD)("div",$e,[(0,s.Wm)(h,{rounded:"",size:"6px",value:n.getPartOfTotal(o),color:"$primary"},null,8,["value"])])):(0,s.kq)("",!0)])),_:2},1032,["class"])))),128))]),"cancelled"!==t.ballot.status&&l.isBallotOpened(t.ballot)?((0,s.wg)(),(0,s.j4)(f,{key:0,class:"capitalize options-btn"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{class:"btn-wrapper"},{default:(0,s.w5)((()=>[t.isAuthenticated?((0,s.wg)(),(0,s.j4)(w,{key:0,labelText:t.$t(n.voteButtonText),btnWidth:"220",fontSize:"16",hoverBlue:"",onClickBtn:e[2]||(e[2]=t=>n.vote())},null,8,["labelText"])):(0,s.kq)("",!0),t.isAuthenticated&&t.ballot.publisher===t.account?((0,s.wg)(),(0,s.j4)(w,{key:1,labelText:t.$t("common.buttons.cancel"),btnWidth:"220",fontSize:"16",hoverRed:"",onClickBtn:e[3]||(e[3]=t=>n.cancel())},null,8,["labelText"])):(0,s.kq)("",!0)])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1})])),_:1}),(0,s.Wm)(r,{class:"q-pb-none cursor-pointer statics-section statics-section-620"},{default:(0,s.w5)((()=>[(0,s._)("div",Fe,[t.ballot.total_voters>0?((0,s.wg)(),(0,s.iD)("div",Me,ze)):(0,s.kq)("",!0)]),n.getWinner.key?((0,s.wg)(),(0,s.iD)("div",Ze,[(0,s._)("span",Le,(0,a.zw)(n.getWinner.key.toUpperCase()),1),(0,s._)("span",Re,(0,a.zw)(n.getPercentofTotal(n.getWinner))+"% ",1)])):(0,s.kq)("",!0),t.ballot.total_voters>0?((0,s.wg)(),(0,s.iD)("div",Ae,[Pe,(0,s._)("div",{class:"statistics-body",onClick:e[4]||(e[4]=t=>n.showVoters())},[(0,s._)("span",Qe,(0,a.zw)(t.ballot.total_voters),1),Ie])])):((0,s.wg)(),(0,s.iD)("div",Ne,[(0,s._)("span",null,(0,a.zw)(n.getWinner),1)])),He,(0,s._)("div",Ge,[(0,s._)("span",Ee,(0,a.zw)(t.onlyNumbers(t.ballot.total_raw_weight))+" ",1),(0,s._)("span",je,(0,a.zw)(t.ballot.total_raw_weight.split(" ")[1])+" ",1)]),t.ballot.proposal_info?((0,s.wg)(),(0,s.iD)("div",Ye,Ke)):(0,s.kq)("",!0),t.ballot.proposal_info?((0,s.wg)(),(0,s.iD)("div",Xe,[(0,s._)("span",tl,(0,a.zw)(n.getRequestAmountRounded(t.ballot.proposal_info.total_requested))+" ",1)])):(0,s.kq)("",!0)])),_:1})])),_:1},8,["class"])])),(0,s._)("div",el,[(0,s.Wm)(u,{class:"popup-right-col",flat:"",square:""},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"description-section-title"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(v,{class:"absolute-top-right gt-xs close-popup-btn",icon:"close",flat:""},null,512),[[C]]),(0,s._)("div",ll,[(0,s._)("span",sl,(0,a.zw)(t.ballot.title||"Untitled Ballot"),1)]),(0,s._)("div",al,[t.ballot.treasury.icon&&""!==t.ballot.treasury.icon&&"null"!==t.ballot.treasury.icon?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s._)("div",ol,[(0,s.Wm)(p,{src:t.ballot.treasury.icon},null,8,["src"])]),(0,s._)("div",null,[(0,s._)("div",null,[il,(0,s._)("a",{class:"link cursor-pointer",onClick:e[5]||(e[5]=e=>n.openUrl(t.ballot.publisher))},(0,a.zw)(t.ballot.publisher),1)]),(0,s._)("div",nl,[rl,(0,s._)("span",ul,(0,a.zw)(t.ballot.treasury.title||"No treasury"),1)])])],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[cl,(0,s._)("a",{class:"link cursor-pointer",onClick:e[6]||(e[6]=e=>n.openUrl(t.ballot.publisher))},(0,a.zw)(t.ballot.publisher),1),pl,(0,s._)("span",dl,(0,a.zw)(t.ballot.treasury.title||"No treasury"),1)],64))]),(0,s.wy)((0,s.Wm)(v,{class:"absolute-top-right lt-sm",icon:"close",flat:""},null,512),[[C]])])),_:1}),(0,s.Wm)(_,{class:"popup-separator"}),(0,s.Wm)(r,{class:"description-section-wrapper"},{default:(0,s.w5)((()=>[(0,s._)("div",ml,[(0,s._)("div",{class:(0,a.C_)(["description-section-title",n.iframeUrl?"q-pb-md":"q-pb-xl q-mb-lg"])},[(0,s._)("p",{innerHTML:n.ballotDescription},null,8,gl)],2),n.ballotContentOptionData&&n.ballotContentOptionData[0]&&n.ballotContentOptionData[0].hasOwnProperty("imageUrl")?((0,s.wg)(),(0,s.iD)("div",bl,[(0,s.Wm)(B,{swipeable:"",animated:"",modelValue:i.defaultSlide,"onUpdate:modelValue":e[9]||(e[9]=t=>i.defaultSlide=t),infinite:"",ref:"carousel"},{control:(0,s.w5)((()=>[(0,s.Wm)(S,{class:"q-gutter-md",position:"bottom-left",offset:[18,18]},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{class:"round-btn",color:"white","text-color":"black",icon:"fas fa-chevron-left",onClick:e[7]||(e[7]=t=>n.prevSlide())}),(0,s.Wm)(v,{class:"round-btn",color:"white","text-color":"black",icon:"fas fa-chevron-right",onClick:e[8]||(e[8]=t=>n.nextSlide())})])),_:1})])),default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.ballotContentOptionData,((t,e)=>((0,s.wg)(),(0,s.j4)(k,{key:e,name:e,"img-src":t.imageUrl},{default:(0,s.w5)((()=>[t.displayText?((0,s.wg)(),(0,s.iD)("div",hl,[(0,s._)("div",fl,(0,a.zw)(t.displayText),1)])):(0,s.kq)("",!0)])),_:2},1032,["name","img-src"])))),128))])),_:1},8,["modelValue"])])):(0,s.kq)("",!0),n.iframeUrl?((0,s.wg)(),(0,s.iD)("iframe",{key:1,class:"kv-preview-data file-preview-pdf file-zoom-detail shadow-1",height:"100%",width:"100%",src:n.iframeUrl},null,8,wl)):((0,s.wg)(),(0,s.iD)("div",yl,kl)),(0,s.Wm)(y,{class:"options-list list-320",dense:""},{default:(0,s.w5)((()=>[(0,s._)("div",Sl,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.ballot.options,(o=>((0,s.wg)(),(0,s.j4)(f,{class:(0,a.C_)(["ballot-view-option no-padding capitalize column",l.displayWinner(t.ballot)?l.displayWinner(t.ballot)===o.key?"option-winner":"":"option-clear"]),key:o.key},{default:(0,s.w5)((()=>[(0,s._)("div",Bl,[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(g,{size:"sm",modelValue:i.votes,"onUpdate:modelValue":e[10]||(e[10]=t=>i.votes=t),disable:"cancelled"!==t.ballot.status&&!l.isBallotOpened,"keep-color":"",class:(0,a.C_)(l.displayWinner(t.ballot)&&l.displayWinner(t.ballot)===o.key?"visible-checkbox":""),color:"$primary",val:o.key},{default:(0,s.w5)((()=>[(0,s._)("div",Wl,[(0,s._)("div",null,(0,a.zw)(o.key),1),n.getPartOfTotal(o)?((0,s.wg)(),(0,s.iD)("div",Tl,(0,a.zw)(n.getPartOfTotalPercent(o))+"% ",1)):(0,s.kq)("",!0)])])),_:2},1032,["modelValue","disable","class","val"])])),_:2},1024)]),l.displayWinner(t.ballot)?((0,s.wg)(),(0,s.iD)("div",Ol,[(0,s.Wm)(h,{rounded:"",size:"6px",value:n.getPartOfTotal(o),color:"$primary"},null,8,["value"])])):(0,s.kq)("",!0)])),_:2},1032,["class"])))),128))]),"cancelled"!==t.ballot.status&&l.isBallotOpened(t.ballot)?((0,s.wg)(),(0,s.j4)(f,{key:0,class:"capitalize options-btn"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,{class:"btn-wrapper"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{class:"btn-vote-320",labelText:t.$t("pages.trails.ballots.vote"),btnWidth:"220",fontSize:"16",hoverBlue:"",onClickBtn:e[11]||(e[11]=e=>t.isAuthenticated?n.vote():n.openNotice())},null,8,["labelText"]),t.isAuthenticated&&t.ballot.publisher===t.account?((0,s.wg)(),(0,s.j4)(w,{key:0,class:"btn-vote-320",labelText:t.$t("common.buttons.cancel"),btnWidth:"220",fontSize:"16",hoverRed:"",onClickBtn:e[12]||(e[12]=t=>n.cancel())},null,8,["labelText"])):(0,s.kq)("",!0)])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(r,{class:"q-pb-none cursor-pointer statics-section statics-section-320"},{default:(0,s.w5)((()=>[(0,s._)("div",xl,[t.ballot.total_voters>0?((0,s.wg)(),(0,s.iD)("div",Cl,[(0,s._)("span",Dl,(0,a.zw)(n.getPercentofTotal(n.getWinner))+"% ",1),(0,s._)("span",Vl,(0,a.zw)(n.getWinner.key.toUpperCase())+" "+(0,a.zw)(l.getLoser.key?` lead over ${l.getLoser.key.toUpperCase()}`:" lead over others"),1)])):((0,s.wg)(),(0,s.iD)("div",ql,[(0,s._)("span",null,(0,a.zw)(n.getWinner),1)])),(0,s._)("div",$l,[(0,s._)("span",Fl,(0,a.zw)(`${t.ballot.total_voters} Accounts`),1),Ml]),(0,s._)("div",Ul,[(0,s._)("span",zl,(0,a.zw)(t.ballot.total_raw_weight.split(" ")[0].split(".")[0])+" ",1),(0,s._)("span",Zl,(0,a.zw)(t.ballot.total_raw_weight.split(" ")[1])+" ",1),Ll]),t.ballot.proposal_info?((0,s.wg)(),(0,s.iD)("div",Rl,[(0,s._)("span",Al,(0,a.zw)(n.getRequestAmountRounded(t.ballot.proposal_info.total_requested))+" ",1),(0,s._)("span",Pl,(0,a.zw)(t.$t("pages.trails.ballots.requestAmount")),1)])):(0,s.kq)("",!0)])])),_:1})])])),_:1})])),_:1}),(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{class:(0,a.C_)(["back-btn row",{scrolled:i.scrollPosition>50}])},[(0,s.Wm)(c,{name:"fas fa-chevron-left"}),Ql],2)),[[C]])]),(0,s.Wm)(T,{modelValue:i.notice,"onUpdate:modelValue":e[13]||(e[13]=t=>i.notice=t)},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{class:"notice"},{default:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"row no-wrap"},{default:(0,s.w5)((()=>[(0,s._)("div",null,[Il,(0,s.Wm)(v,{class:"register-link",flat:"",size:"14px",color:"primary",label:"here",to:"/accounts/add","no-caps":""})])])),_:1}),(0,s.Wm)(W,{class:"bg-white",align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(v,{flat:"",label:"OK"},null,512),[[C]])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)):((0,s.wg)(),(0,s.j4)(x,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(O,{size:"3em"})])),_:1}))],32)}var Hl=l(17779);const Gl=new RegExp(/Qm[1-9A-HJ-NP-Za-km-z]{44}(\/.*)?/,"m"),El=new RegExp(/https?\:\/\/.*Qm[1-9A-HJ-NP-Za-km-z]{44}(\/.*)?/,"m"),jl={name:"BallotView",components:{BallotStatus:Xt,BallotChip:re,Btn:ue.Z},props:{isBallotOpened:{type:Function,required:!0},displayWinner:{type:Function,required:!0},votingHasBegun:{type:Function,required:!0},getStartTime:{type:Function,required:!0},getEndTime:{type:Function,required:!0},getLoser:{type:Function,required:!0},ballotContentImg:{type:Function,required:!0}},data(){return{loading:!0,voting:!1,votes:[],defaultSlide:0,scrollPosition:null,notice:!1,showDetails:!1}},async mounted(){await this.fetchBallot(this.$route.params.id),window.addEventListener("scroll",this.updateScroll),this.loading=!1},beforeUnmount(){},computed:{...(0,u.Se)("notifications",["notifications"]),...(0,u.Se)("accounts",["isAuthenticated","account"]),...(0,u.Se)("trails",["ballot","voters","userTreasury"]),daysSinceStarted(){const t=864e5,e=Date.now(),l=new Date(this.ballot.begin_time).getTime(),s=Math.round(Math.abs((e-l)/t));return s},getWinner(){if(!this.ballot.total_voters)return"No votes";let t,e=-1;return this.ballot.options.forEach(((l,s)=>{parseFloat(l.value)>e&&(e=parseFloat(l.value),t=s)})),this.ballot.options[t]},ballotDescription(){if(this.iframeUrl)return this.ballot.description.replace(El,"").replace(Gl,"");const t=this.findLinks(this.ballot.description);return t},ballotContent(){return this.ballot.content.match(Gl)?this.ballot.content.replace(El,"").replace(Gl,""):this.ballot.content},ballotContentOptionData(){try{const t=Object.values(JSON.parse(this.ballot.content).optionData);return t}catch(t){return null}},iframeUrl(){let t=this.ballot.content,e=null;try{t=JSON.parse(this.ballot.content)}catch(l){}try{e=Gl.exec(this.ballot.description)}catch(l){}if(Array.isArray(e)){const t="https://ipfs.io/ipfs/"+e[0];return t}if("object"===typeof t){const e=t.contentUrl||(t.contentUrls||[])[0]||t.imageUrl||(t.imageUrls||[])[0];return e}return!1},getVariants(){let t=[];for(let e of this.ballot.options)this.onlyNumbers(e.value)>0&&t.push(e);return t},isUserRegisteredInTreasury(){return!!this.ballot&&this.userTreasury.some((t=>t.liquid.split(" ")[1]==this.ballot.treasury.supply.split(" ")[1]))},voteButtonText(){return Hl.log("BalllotView.voteButtonText() isUserRegisteredInTreasury: ",this.isUserRegisteredInTreasury),this.isUserRegisteredInTreasury?"pages.trails.ballots.vote":"pages.trails.ballots.joinDAOFirst"}},methods:{...(0,u.nv)("trails",["fetchBallot","castVote","cancelBallot","fetchVotesForBallot","fetchTreasuriesForUser"]),openUrl(t){window.open(`https://explorer-test.telos.net/account/${t}`)},getPercentofTotal(t){const e=Number(t.value.split(" ")[0])/Number(this.ballot.total_raw_weight.split(" ")[0])*100;return Number.isInteger(e)?e:+e.toFixed(2)},async onCastVote({options:t,option:e,ballotName:l,register:s}){this.voting=!0,await this.castVote({register:s,ballotName:l,options:t||[e]}),this.voting=!1,this.votes=[]},showNotification(){this.$q.notify({icon:this.notifications[0].icon,message:"success"===this.notifications[0].status?this.$t("notifications.trails.successSigning"):this.$t("notifications.trails.errorSigning"),color:"success"===this.notifications[0].status?"positive":"negative"})},async showVoters(){await this.fetchVotesForBallot({name:this.ballot.ballot_name,limit:this.ballot.total_voters}),this.voters.length>0?this.showDetails=!0:this.showDetails=!1},getVoters(t){let e=[];const l=JSON.stringify(this.voters);for(let s of JSON.parse(l))for(let l of s.weighted_votes)l.key===t&&(s.value=l.value,e.push(s));return e},...(0,u.nv)("trails",["registerVoter"]),async onRegisterVoter(t){await this.registerVoter(t)},async vote(){let t=!1;if(!this.isUserRegisteredInTreasury)return Hl.log("this.ballot.treasury: ",this.ballot.treasury.max_supply),await this.onRegisterVoter(this.ballot.treasury.max_supply),this.showNotification(),void this.fetchTreasuriesForUser(this.account);t=!1,await this.onCastVote({register:t,options:this.votes,ballotName:this.ballot.ballot_name}),await this.fetchBallot(this.$route.params.id),this.showNotification()},async cancel(){await this.cancelBallot(this.ballot),this.showNotification()},nextSlide(){this.ballotContentOptionData.length-1>this.defaultSlide&&this.defaultSlide++},prevSlide(){this.defaultSlide>0&&this.defaultSlide--},updatePopupScroll(t){this.scrollPosition=t.target.scrollTop},getPartOfTotalPercent(t){return this.trunc(100*this.getPartOfTotal(t),2)},getPartOfTotal(t){if(t)return isNaN(this.getPercentofTotal(t))?0:this.getPercentofTotal(t)/100},openNotice(){this.notice=!0},toggleOption(t){1===this.ballot.max_options&&(this.votes=this.votes.includes(t)?[t]:[])},findLinks(t){const e=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return t.replace(e,(t=>`<a href="${t}">${t}</a>`))},getRequestAmountRounded(t){const e=t.split(" "),l=parseInt(e[0]),s=e[1];return`${l} ${s}`}}};var Yl=l(13246),Jl=l(490),Kl=l(76749),Xl=l(11221),ts=l(8289),es=l(97052),ls=l(41694),ss=l(10033),as=l(60854),os=l(13902);const is=(0,v.Z)(jl,[["render",Nl]]),ns=is;U()(jl,"components",{QCard:k.Z,QCardSection:S.Z,QImg:de.Z,QIcon:O.Z,QList:Yl.Z,QItem:Jl.Z,QItemSection:Kl.Z,QCheckbox:Xl.Z,QLinearProgress:ts.Z,QBtn:$.Z,QSeparator:me.Z,QCarousel:es.Z,QCarouselSlide:ls.Z,QCarouselControl:ss.Z,QDialog:_.Z,QCardActions:q.Z,QInnerLoading:as.Z,QSpinner:os.Z}),U()(jl,"directives",{ClosePopup:F.Z});const rs=t=>((0,s.dD)("data-v-4c927356"),t=t(),(0,s.Cn)(),t),us=rs((()=>(0,s._)("img",{class:"bg320px absolute-top",src:"statics/welcome-card-bg320px.png"},null,-1))),cs=rs((()=>(0,s._)("img",{class:"bg1 absolute-right",src:"statics/welcome-card-bg1.png"},null,-1))),ps=rs((()=>(0,s._)("img",{class:"bg2 absolute-right",src:"statics/welcome-card-bg2.png"},null,-1))),ds=rs((()=>(0,s._)("img",{class:"bg3 absolute",src:"statics/welcome-card-bg3.png"},null,-1))),ms={class:"card-title"},gs=rs((()=>(0,s._)("img",{class:"self-center title-img",src:"statics/hello.png"},null,-1))),bs={class:"q-pt-none"},hs={class:"q-pt-none text-weight-bold"},fs={class:"q-pt-none"};function ws(t,e,l,o,i,n){const r=(0,s.up)("q-card-section"),u=(0,s.up)("btn"),c=(0,s.up)("q-card-actions"),p=(0,s.up)("q-card");return(0,s.wg)(),(0,s.j4)(Zt.uT,{name:"fade"},{default:(0,s.w5)((()=>[i.isNewUser?((0,s.wg)(),(0,s.j4)(p,{key:0,class:"welcome-card",flat:"",bordered:""},{default:(0,s.w5)((()=>[us,cs,ps,ds,(0,s.Wm)(r,{class:"title-wrapper row"},{default:(0,s.w5)((()=>[(0,s._)("div",ms,(0,a.zw)(t.$t("pages.trails.ballots.welcomeCard.title"))+" "+(0,a.zw)(t.account)+"!",1),gs])),_:1}),(0,s.Wm)(r,{class:"card-text"},{default:(0,s.w5)((()=>[(0,s._)("div",bs,[(0,s.Uk)((0,a.zw)(t.$t("pages.trails.ballots.welcomeCard.textBeginning")),1),(0,s._)("span",hs,(0,a.zw)(t.$t("pages.trails.ballots.welcomeCard.textBold")),1),(0,s._)("span",fs,(0,a.zw)(t.$t("pages.trails.ballots.welcomeCard.textEnd")),1)])])),_:1}),(0,s.Wm)(c,{class:"btn-wrapper"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{labelText:t.$t("pages.trails.ballots.welcomeCard.btnLabel"),primary:"",btnWidth:"94",onClickBtn:e[0]||(e[0]=t=>n.addToLocalStorage()),fontSize:"16"},null,8,["labelText"])])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1})}const ys={name:"WelcomeCard",components:{Btn:ue.Z},data(){return{isNewUser:!0}},computed:{...(0,u.Se)("accounts",["account"])},methods:{addToLocalStorage(){localStorage.isNewUser=!1,this.isNewUser=!1}}},vs=(0,v.Z)(ys,[["render",ws],["__scopeId","data-v-4c927356"]]),_s=vs;U()(ys,"components",{QCard:k.Z,QCardSection:S.Z,QCardActions:q.Z});const ks={class:"bar-filter-wrapper"},Ss={class:"column bar-filter-menu-320-wrapper"},Bs={class:"bar-filter-menu-320 column"},Ws={class:"menu-320-title-wrapper row items-center"},Ts={class:"menu-320-title"},Os={class:"dialog-btn-wrapper column"},xs={key:0},Cs={class:"column dialog-wrapper"},Ds={class:"flex justify-between dialog-title"},Vs={class:"flex items-center"},qs={class:"user-name"},$s={key:1,class:"flex no-wrap"},Fs={class:"column dialog-wrapper"},Ms={class:"flex justify-between dialog-title"},Us={class:"flex items-center"},zs={class:"user-name"},Zs={key:2},Ls={class:"column dialog-wrapper"},Rs={class:"flex justify-between dialog-title"},As={class:"flex items-center"},Ps={class:"user-name"},Qs={class:"menu-form-btns-wrapper row justify-between"},Is={key:3,class:"flex no-wrap"},Ns={class:"column dialog-wrapper"},Hs={class:"flex justify-between dialog-title"},Gs={class:"flex items-center"},Es={class:"user-name"},js={class:"menu-form-btns-wrapper row justify-between"},Ys={key:4},Js={class:"column dialog-wrapper"},Ks={class:"flex justify-between dialog-title"},Xs={class:"flex items-center"},ta={class:"user-name"},ea={class:"menu-form-btns-wrapper row justify-between"},la={key:5,class:"flex no-wrap"},sa={class:"column dialog-wrapper"},aa={class:"flex justify-between dialog-title"},oa={class:"flex items-center"},ia={class:"user-name"},na={class:"menu-form-btns-wrapper row justify-between"},ra={key:6},ua={class:"column dialog-wrapper"},ca={class:"flex justify-between dialog-title"},pa={class:"flex items-center"},da={class:"user-name"},ma={key:7,class:"flex no-wrap"},ga={class:"column dialog-wrapper"},ba={class:"flex justify-between dialog-title"},ha={class:"flex items-center"},fa={class:"user-name"},wa={class:"btn-320-wrapper row items-center scroll-anim"},ya=(0,s._)("div",{class:"bar-linear-gradient-left"},null,-1),va=(0,s._)("div",{class:"bar-linear-gradient-right"},null,-1),_a=(0,s._)("div",{class:"bar-custom-separator"},null,-1),ka={class:"bar-filters"},Sa={class:"row bar-filter-btns-wrapper"},Ba={key:1},Wa={key:3},Ta={key:5},Oa={key:7},xa=(0,s._)("div",{class:"separator-320"},null,-1),Ca={class:"right-bar-section col-grow row items-center justify-end hidden"},Da=(0,s.Uk)("You have to be logged in to create a poll. If you don't have account please register");function Va(t,e,l,o,i,n){const r=(0,s.up)("q-icon"),u=(0,s.up)("q-btn"),c=(0,s.up)("q-option-group"),p=(0,s.up)("q-scroll-area"),d=(0,s.up)("q-dialog"),m=(0,s.up)("btn"),g=(0,s.up)("q-form"),b=(0,s.up)("q-btn-toggle"),h=(0,s.up)("q-menu"),f=(0,s.up)("q-separator"),w=(0,s.up)("q-card-section"),y=(0,s.up)("q-card-actions"),v=(0,s.up)("q-card"),_=(0,s.Q2)("close-popup");return(0,s.wg)(),(0,s.iD)("div",ks,[(0,s._)("div",Ss,[(0,s._)("div",Bs,[(0,s._)("div",Ws,[(0,s._)("div",Ts,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.filterTitle")),1),(0,s.Wm)(r,{class:"filter-icon",name:"filter_list"})]),(0,s._)("div",Os,[i.sortMode?((0,s.wg)(),(0,s.iD)("div",$s,[(0,s.Wm)(u,{class:"bar-filter-btn left-btn left-btn-320",label:i.sortMode,onClick:e[3]||(e[3]=t=>n.toggleMenu("isSortingDialogOpen")),color:"dark","no-caps":""},null,8,["label"]),(0,s.Wm)(d,{modelValue:i.isSortingDialogOpen,"onUpdate:modelValue":e[5]||(e[5]=t=>i.isSortingDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",Fs,[(0,s._)("div",Ms,[(0,s._)("div",Us,[(0,s._)("div",zs,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.sorting")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",modelValue:i.sortMode,"onUpdate:modelValue":e[4]||(e[4]=t=>i.sortMode=t),options:i.sortOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])])),_:1},8,["modelValue"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn right-btn-320",onClick:e[6]||(e[6]=t=>n.clearSort()),icon:"close",color:"dark"})])):((0,s.wg)(),(0,s.iD)("div",xs,[(0,s.Wm)(u,{class:"dialog-btn filter-type-btn-320",label:t.$t("pages.trails.ballots.actionBar.sorting"),"icon-right":"fas fa-chevron-down",onClick:e[0]||(e[0]=t=>n.toggleMenu("isSortingDialogOpen")),color:"dark","no-caps":"",outline:"",flat:"",align:"left"},null,8,["label"]),(0,s.Wm)(d,{modelValue:i.isSortingDialogOpen,"onUpdate:modelValue":e[2]||(e[2]=t=>i.isSortingDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",Cs,[(0,s._)("div",Ds,[(0,s._)("div",Vs,[(0,s._)("div",qs,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.sorting")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",modelValue:i.sortMode,"onUpdate:modelValue":e[1]||(e[1]=t=>i.sortMode=t),options:i.sortOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])])),_:1},8,["modelValue"])])),0===i.submitTypesResult.length?((0,s.wg)(),(0,s.iD)("div",Zs,[l.election?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:0,class:"dialog-btn filter-type-btn-320",label:t.$t("pages.trails.ballots.actionBar.typeFilter"),"icon-right":"fas fa-chevron-down",onClick:e[7]||(e[7]=t=>n.toggleMenu("isTypeDialogOpen")),color:"dark","no-caps":"",outline:"",flat:"",align:"left"},null,8,["label"])),(0,s.Wm)(d,{modelValue:i.isTypeDialogOpen,"onUpdate:modelValue":e[10]||(e[10]=t=>i.isTypeDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",Ls,[(0,s._)("div",Rs,[(0,s._)("div",As,[(0,s._)("div",Ps,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.typeFilter")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s._)("div",null,[(0,s.Wm)(g,{class:"bar-filter-menu-form dialog-form",onSubmit:n.onSubmitTypes},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",name:"type",modelValue:i.typeGroup,"onUpdate:modelValue":e[8]||(e[8]=t=>i.typeGroup=t),options:n.typeOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s._)("div",Qs,[(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnDiscard"),onClickBtn:e[9]||(e[9]=t=>n.discardFilter("submitTypesResult","typeGroup")),btnWidth:"142",fontSize:"15"},null,8,["labelText"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnApply"),primary:"",type:"submit",btnWidth:"142",fontSize:"15"},null,8,["labelText"])])])),_:1},8,["onSubmit"])])])])),_:1},8,["modelValue"])])):((0,s.wg)(),(0,s.iD)("div",Is,[l.election?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(u,{key:0,class:"bar-filter-btn left-btn left-btn-320",label:n.getFilterBtnLabel(t.$t("pages.trails.ballots.actionBar.typeFilter"),"submitTypesResult","typeOptions"),onClick:e[11]||(e[11]=t=>n.toggleMenu("isTypeDialogOpen")),color:"dark","no-caps":""},null,8,["label"])),(0,s.Wm)(d,{modelValue:i.isTypeDialogOpen,"onUpdate:modelValue":e[14]||(e[14]=t=>i.isTypeDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",Ns,[(0,s._)("div",Hs,[(0,s._)("div",Gs,[(0,s._)("div",Es,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.typeFilter")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s._)("div",null,[(0,s.Wm)(g,{class:"bar-filter-menu-form dialog-form",onSubmit:n.onSubmitTypes},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",name:"type",modelValue:i.typeGroup,"onUpdate:modelValue":e[12]||(e[12]=t=>i.typeGroup=t),options:n.typeOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s._)("div",js,[(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnDiscard"),onClickBtn:e[13]||(e[13]=t=>n.discardFilter("submitTypesResult","typeGroup")),btnWidth:"142",fontSize:"15"},null,8,["labelText"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnApply"),primary:"",type:"submit",btnWidth:"142",fontSize:"15"},null,8,["labelText"])])])),_:1},8,["onSubmit"])])])])),_:1},8,["modelValue"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn right-btn-320",onClick:e[15]||(e[15]=t=>n.clearFilter("submitTypesResult","isTypeMenuOpen")),icon:"close",color:"dark"})])),0===i.submitStatusesResult.length?((0,s.wg)(),(0,s.iD)("div",Ys,[(0,s.Wm)(u,{class:"dialog-btn filter-type-btn-320",label:t.$t("pages.trails.ballots.actionBar.statusFilter"),"icon-right":"fas fa-chevron-down",onClick:e[16]||(e[16]=t=>n.toggleMenu("isStatusDialogOpen")),color:"dark","no-caps":"",outline:"",flat:"",align:"left"},null,8,["label"]),(0,s.Wm)(d,{modelValue:i.isStatusDialogOpen,"onUpdate:modelValue":e[19]||(e[19]=t=>i.isStatusDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",Js,[(0,s._)("div",Ks,[(0,s._)("div",Xs,[(0,s._)("div",ta,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.statusFilter")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s._)("div",null,[(0,s.Wm)(g,{class:"bar-filter-menu-form dialog-form",onSubmit:n.onSubmitStatuses},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",name:"status",modelValue:i.statusGroup,"onUpdate:modelValue":e[17]||(e[17]=t=>i.statusGroup=t),options:i.statusOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s._)("div",ea,[(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnDiscard"),onClickBtn:e[18]||(e[18]=t=>n.discardFilter("submitStatusesResult","statusGroup")),btnWidth:"142",fontSize:"15"},null,8,["labelText"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnApply"),primary:"",type:"submit",btnWidth:"142",fontSize:"15"},null,8,["labelText"])])])),_:1},8,["onSubmit"])])])])),_:1},8,["modelValue"])])):((0,s.wg)(),(0,s.iD)("div",la,[(0,s.Wm)(u,{class:"bar-filter-btn left-btn left-btn-320",label:n.getFilterBtnLabel(t.$t("pages.trails.ballots.actionBar.statusFilter"),"submitStatusesResult","statusOptions"),onClick:e[20]||(e[20]=t=>n.toggleMenu("isStatusDialogOpen")),color:"dark","no-caps":""},null,8,["label"]),(0,s.Wm)(d,{modelValue:i.isStatusDialogOpen,"onUpdate:modelValue":e[23]||(e[23]=t=>i.isStatusDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",sa,[(0,s._)("div",aa,[(0,s._)("div",oa,[(0,s._)("div",ia,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.statusFilter")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s._)("div",null,[(0,s.Wm)(g,{class:"bar-filter-menu-form dialog-form",onSubmit:n.onSubmitStatuses},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",name:"status",modelValue:i.statusGroup,"onUpdate:modelValue":e[21]||(e[21]=t=>i.statusGroup=t),options:i.statusOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s._)("div",na,[(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnDiscard"),onClickBtn:e[22]||(e[22]=t=>n.discardFilter("submitStatusesResult","statusGroup")),btnWidth:"142",fontSize:"15"},null,8,["labelText"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnApply"),primary:"",type:"submit",btnWidth:"142",fontSize:"15"},null,8,["labelText"])])])),_:1},8,["onSubmit"])])])])),_:1},8,["modelValue"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn right-btn-320",onClick:e[24]||(e[24]=t=>n.clearFilter("submitStatusesResult","isStatusDialogOpen")),icon:"close",color:"dark"})])),i.treasuryBar?((0,s.wg)(),(0,s.iD)("div",ma,[(0,s.Wm)(u,{class:"bar-filter-btn left-btn left-btn-320",label:i.treasuryBar,onClick:e[28]||(e[28]=t=>n.toggleMenu("isGroupDialogOpen")),color:"dark","no-caps":""},null,8,["label"]),(0,s.Wm)(d,{modelValue:i.isGroupDialogOpen,"onUpdate:modelValue":e[30]||(e[30]=t=>i.isGroupDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",ga,[(0,s._)("div",ba,[(0,s._)("div",ha,[(0,s._)("div",fa,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.groupFilter")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",modelValue:i.treasuryBar,"onUpdate:modelValue":e[29]||(e[29]=t=>i.treasuryBar=t),options:l.treasuriesOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])])),_:1},8,["modelValue"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn right-btn-320",onClick:e[31]||(e[31]=t=>n.clearGroupFilter()),icon:"close",color:"dark"})])):((0,s.wg)(),(0,s.iD)("div",ra,[(0,s.Wm)(u,{class:"dialog-btn filter-type-btn-320",label:t.$t("pages.trails.ballots.actionBar.groupFilter"),"icon-right":"fas fa-chevron-down",onClick:e[25]||(e[25]=t=>n.toggleMenu("isGroupDialogOpen")),color:"dark","no-caps":"",outline:"",flat:"",align:"left"},null,8,["label"]),(0,s.Wm)(d,{modelValue:i.isGroupDialogOpen,"onUpdate:modelValue":e[27]||(e[27]=t=>i.isGroupDialogOpen=t),position:"bottom"},{default:(0,s.w5)((()=>[(0,s._)("div",ua,[(0,s._)("div",ca,[(0,s._)("div",pa,[(0,s._)("div",da,(0,a.zw)(t.$t("pages.trails.ballots.actionBar.groupFilter")),1)]),(0,s.wy)((0,s.Wm)(u,{class:"close-btn",flat:"",dense:"",round:"",icon:"close","text-color":"dark"},null,512),[[_]])]),(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options options-320",modelValue:i.treasuryBar,"onUpdate:modelValue":e[26]||(e[26]=t=>i.treasuryBar=t),options:l.treasuriesOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])])),_:1},8,["modelValue"])]))]),n.isFiltersApplied()?((0,s.wg)(),(0,s.j4)(m,{key:0,class:"discard-all-btn",labelText:t.$t("pages.trails.ballots.actionBar.btnDiscardAll"),onClickBtn:e[32]||(e[32]=t=>n.discardAllFilter()),fontSize:"15"},null,8,["labelText"])):(0,s.kq)("",!0)]),(0,s._)("div",wa,[(0,s.Wm)(m,{class:"create-poll-btn btn-320",iconRight:"",labelText:t.$t("pages.trails.ballots.actionBar.btnCreatePoll"),primary:"",btnWidth:"155",fontSize:"16",padding:"0",onClickBtn:e[33]||(e[33]=e=>t.isAuthenticated?n.openBallotForm():n.openNotice())},null,8,["labelText"])])]),(0,s._)("div",{class:(0,a.C_)(["bar-wrapper row items-center",{"menu-visible":i.isFilterMenu320Open}])},[ya,va,(0,s.Wm)(b,{class:"bar-btns-toggle",modelValue:i.isBallotListRowDirection,"onUpdate:modelValue":e[34]||(e[34]=t=>i.isBallotListRowDirection=t),flat:"","toggle-color":"primary",options:[{value:!0,slot:"row"},{value:!1,slot:"column"}]},{row:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"bar-btn-toggle",name:"eva-grid-outline"})])),column:(0,s.w5)((()=>[(0,s.Wm)(r,{class:"bar-btn-toggle",name:"fas fa-bars"})])),_:1},8,["modelValue"]),_a,(0,s._)("div",ka,[(0,s._)("div",Sa,[i.sortMode?((0,s.wg)(),(0,s.iD)("div",Ba,[(0,s.Wm)(u,{class:"bar-filter-btn left-btn",label:i.sortMode,color:"dark","no-caps":""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{onShow:e[39]||(e[39]=t=>n.toggleMenu("isSortingMenuOpen")),onHide:e[40]||(e[40]=t=>n.toggleMenu("isSortingMenuOpen")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options",modelValue:i.sortMode,"onUpdate:modelValue":e[38]||(e[38]=t=>i.sortMode=t),options:i.sortOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])),_:1},8,["label"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn",onClick:n.clearSort,icon:"close",color:"dark"},null,8,["onClick"])])):((0,s.wg)(),(0,s.j4)(u,{key:0,class:(0,a.C_)(["bar-filter-btn",{"menu-open":i.isSortingMenuOpen}]),label:"Sort by","icon-right":i.isSortingMenuOpen?"fas fa-chevron-up":"fas fa-chevron-down",color:"dark","no-caps":"",outline:""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{onShow:e[36]||(e[36]=t=>n.toggleMenu("isSortingMenuOpen")),onHide:e[37]||(e[37]=t=>n.toggleMenu("isSortingMenuOpen")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options",modelValue:i.sortMode,"onUpdate:modelValue":e[35]||(e[35]=t=>i.sortMode=t),options:i.sortOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])),_:1},8,["class","icon-right"])),0!==i.submitTypesResult.length||l.election?l.election?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",Wa,[(0,s.Wm)(u,{class:"bar-filter-btn left-btn",label:n.getFilterBtnLabel(t.$t("pages.trails.ballots.actionBar.typeFilter"),"submitTypesResult","typeOptions"),color:"dark","no-caps":""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{ref:"typesMenu",onShow:e[45]||(e[45]=t=>n.toggleMenu("isTypeMenuOpen")),onHide:e[46]||(e[46]=t=>n.toggleMenu("isTypeMenuOpen","typeGroup","submitTypesResult")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bar-filter-menu-form",onSubmit:n.onSubmitTypes},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options",name:"type",modelValue:i.typeGroup,"onUpdate:modelValue":e[44]||(e[44]=t=>i.typeGroup=t),options:n.typeOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnConfirm"),primary:"",type:"submit",btnWidth:"161",fontSize:"16"},null,8,["labelText"])])),_:1},8,["onSubmit"])])),_:1},512)])),_:1},8,["label"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn",onClick:e[47]||(e[47]=t=>n.clearFilter("submitTypesResult","isTypeMenuOpen")),icon:"close",color:"dark"})])):((0,s.wg)(),(0,s.j4)(u,{key:2,class:(0,a.C_)(["bar-filter-btn",{"menu-open":i.isTypeMenuOpen}]),label:t.$t("pages.trails.ballots.actionBar.typeFilter"),"icon-right":i.isTypeMenuOpen?"fas fa-chevron-up":"fas fa-chevron-down",color:"dark","no-caps":"",outline:""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{ref:"typesMenu",onShow:e[42]||(e[42]=t=>n.toggleMenu("isTypeMenuOpen")),onHide:e[43]||(e[43]=t=>n.toggleMenu("isTypeMenuOpen","typeGroup","submitTypesResult")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bar-filter-menu-form",onSubmit:n.onSubmitTypes},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options",name:"type",modelValue:i.typeGroup,"onUpdate:modelValue":e[41]||(e[41]=t=>i.typeGroup=t),options:n.typeOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnConfirm"),primary:"",type:"submit",btnWidth:"142",fontSize:"16"},null,8,["labelText"])])),_:1},8,["onSubmit"])])),_:1},512)])),_:1},8,["label","class","icon-right"])),0===i.submitStatusesResult.length?((0,s.wg)(),(0,s.j4)(u,{key:4,class:(0,a.C_)(["bar-filter-btn",{"menu-open":i.isStatusMenuOpen}]),label:t.$t("pages.trails.ballots.actionBar.statusFilter"),"icon-right":i.isStatusMenuOpen?"fas fa-chevron-up":"fas fa-chevron-down",color:"dark","no-caps":"",outline:""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{ref:"statusesMenu",onShow:e[49]||(e[49]=t=>n.toggleMenu("isStatusMenuOpen")),onHide:e[50]||(e[50]=t=>n.toggleMenu("isStatusMenuOpen","statusGroup","submitStatusesResult")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bar-filter-menu-form",onSubmit:n.onSubmitStatuses},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{name:"status",modelValue:i.statusGroup,"onUpdate:modelValue":e[48]||(e[48]=t=>i.statusGroup=t),options:i.statusOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnConfirm"),primary:"",type:"submit",btnWidth:"161",fontSize:"16"},null,8,["labelText"])])),_:1},8,["onSubmit"])])),_:1},512)])),_:1},8,["label","class","icon-right"])):((0,s.wg)(),(0,s.iD)("div",Ta,[(0,s.Wm)(u,{class:"bar-filter-btn left-btn",label:n.getFilterBtnLabel(t.$t("pages.trails.ballots.actionBar.statusFilter"),"submitStatusesResult","statusOptions"),color:"dark","no-caps":""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{ref:"statusesMenu",onShow:e[52]||(e[52]=t=>n.toggleMenu("isStatusMenuOpen")),onHide:e[53]||(e[53]=t=>n.toggleMenu("isStatusMenuOpen","statusGroup","submitStatusesResult")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{class:"bar-filter-menu-form",onSubmit:n.onSubmitStatuses},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{name:"status",modelValue:i.statusGroup,"onUpdate:modelValue":e[51]||(e[51]=t=>i.statusGroup=t),options:i.statusOptions,color:"primary",type:"checkbox"},null,8,["modelValue","options"]),(0,s.Wm)(m,{labelText:t.$t("pages.trails.ballots.actionBar.btnConfirm"),primary:"",type:"submit",btnWidth:"161",fontSize:"16"},null,8,["labelText"])])),_:1},8,["onSubmit"])])),_:1},512)])),_:1},8,["label"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn",onClick:e[54]||(e[54]=t=>n.clearFilter("submitStatusesResult","isStatusMenuOpen")),icon:"close",color:"dark"})])),i.treasuryBar?((0,s.wg)(),(0,s.iD)("div",Oa,[(0,s.Wm)(u,{class:"bar-filter-btn left-btn",label:i.treasuryBar,color:"dark","no-caps":""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{onShow:e[59]||(e[59]=t=>n.toggleMenu("isGroupMenuOpen")),onHide:e[60]||(e[60]=t=>n.toggleMenu("isGroupMenuOpen")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options",modelValue:i.treasuryBar,"onUpdate:modelValue":e[58]||(e[58]=t=>i.treasuryBar=t),options:l.treasuriesOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])),_:1},8,["label"]),(0,s.Wm)(u,{class:"bar-filter-btn right-btn",onClick:e[61]||(e[61]=t=>n.clearGroupFilter()),icon:"close",color:"dark"})])):((0,s.wg)(),(0,s.j4)(u,{key:6,class:(0,a.C_)(["bar-filter-btn",{"menu-open":i.isGroupMenuOpen}]),label:t.$t("pages.trails.ballots.actionBar.groupFilter"),"icon-right":i.isGroupMenuOpen?"fas fa-chevron-up":"fas fa-chevron-down",color:"dark","no-caps":"",outline:""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{onShow:e[56]||(e[56]=t=>n.toggleMenu("isGroupMenuOpen")),onHide:e[57]||(e[57]=t=>n.toggleMenu("isGroupMenuOpen")),fit:"",offset:[30,20]},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{class:"bar-filter-menu-options",modelValue:i.treasuryBar,"onUpdate:modelValue":e[55]||(e[55]=t=>i.treasuryBar=t),options:l.treasuriesOptions,color:"primary"},null,8,["modelValue","options"])])),_:1})])),_:1},8,["label","class","icon-right"]))])]),(0,s.Wm)(u,{class:"bar-filter-btn-320",label:t.$t("pages.trails.ballots.actionBar.filterTitle"),"icon-right":"filter_list",onClick:e[62]||(e[62]=t=>n.handleFilterBtnClick()),color:"dark","no-caps":"",outline:""},null,8,["label"]),xa,(0,s._)("div",Ca,[(0,s.Wm)(f,{class:"bar-separator-vertical",vertical:"",inset:""}),(0,s.Wm)(m,{class:"create-poll-btn",labelText:t.$t("pages.trails.ballots.actionBar.btnCreatePoll"),iconRight:"",padding:"0",primary:"",btnWidth:"155",fontSize:"16",onClickBtn:e[63]||(e[63]=e=>t.isAuthenticated?n.openBallotForm():n.openNotice())},null,8,["labelText"])])],2),(0,s.Wm)(d,{modelValue:i.notice,"onUpdate:modelValue":e[64]||(e[64]=t=>i.notice=t)},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{class:"notice"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{class:"row no-wrap"},{default:(0,s.w5)((()=>[(0,s._)("div",null,[Da,(0,s.Wm)(u,{class:"register-link",flat:"",size:"14px",color:"primary",label:"here",to:"/accounts/add","no-caps":""})])])),_:1}),(0,s.Wm)(y,{class:"bg-white",align:"right"},{default:(0,s.w5)((()=>[(0,s.wy)((0,s.Wm)(u,{flat:"",label:"OK"},null,512),[[_]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}var qa=l(43701),$a=l(17779);const Fa={name:"ActionBar",components:{Btn:ue.Z},props:{treasuriesOptions:{},activeFilter:{type:String},election:{type:Boolean,default:!1}},data(){return{model:"one",isTypeMenuOpen:!1,isStatusMenuOpen:!1,isGroupMenuOpen:!1,isSortingMenuOpen:!1,isTypeDialogOpen:!1,isStatusDialogOpen:!1,isGroupDialogOpen:!1,isSortingDialogOpen:!1,isConfirmBtn:!1,isFilterMenu320Open:!1,typeGroup:[],electionsPageTypeOptions:[{label:"Election",value:"election"},{label:"Referendum",value:"referendum"},{label:"Leaderboard",value:"leaderboard"}],proposalsPageTypeOptions:[{label:"Poll",value:"poll"},{label:"Proposal",value:"proposal"}],statusGroup:[],statusOptions:[{label:"Active",value:"active"},{value:"not_started",label:"Not started"},{label:"Expired",value:"expired"},{label:"Closed",value:"closed"},{label:"Cancelled",value:"cancelled"},{label:"Archived",value:"archived"},{label:"Setup",value:"setup"}],sortMode:"",sortOptions:[{label:"A-Z",value:"A-Z"},{label:"Z-A",value:"Z-A"},{label:"Most popular",value:"Most popular"},{label:"Least popular",value:"Least popular"}],submitTypesResult:[],submitStatusesResult:[],treasuryBar:"VOTE",isBallotListRowDirection:!0,notice:!1}},methods:{...(0,u.nv)("trails",["fetchFees","fetchBallots","castVote","fetchTreasuries","fetchBallotsByStatus"]),...(0,u.OI)("trails",["resetBallots","stopAddBallots"]),addToLocalStorage(){localStorage.isNewUser=!1,this.isNewUser=!1},openBallotForm(){this.$emit("open-ballot-form")},toggleMenu(t,e,l){this[l]&&(this[e]=this[l]),this[t]=!this[t]},onSubmitTypes(t){const e=new FormData(t.target),l=[];for(const[s,a]of e.entries())l.push({name:s,value:a});this.submitTypesResult=JSON.parse(JSON.stringify(l)).reduce(((t,e)=>[...t,e.value]),[]),this.$refs.typesMenu.hide()},onSubmitStatuses(t){const e=new FormData(t.target),l=[];for(const[s,a]of e.entries())l.push({name:s,value:a});this.submitStatusesResult=JSON.parse(JSON.stringify(l)).reduce(((t,e)=>[...t,e.value]),[]),this.$refs.statusesMenu.hide()},clearFilter(t,e){this[t]=[],this[e]=!1},discardFilter(t,e){this[e]=[],this[t]=[]},discardAllFilter(){this.treasuryBar=null,this.submitTypesResult=[],this.submitStatusesResult=[]},clearGroupFilter(){this.treasuryBar=null,this.isGroupMenuOpen=!1},clearSort(){this.sortMode="",this.isSortingMenuOpen=!1},isFiltersApplied(){return null!==this.treasuryBar||this.submitTypesResult.length||this.submitStatusesResult.length},getFilterBtnLabel(t,e,l){if(1===this[e].length){const t=this[l].find((t=>t.value===this[e][0])).label;return t}return`${t}: ${this[e].length}`},handleScroll(){const t=this.$el.querySelector(".scroll-anim"),e=this.$el.querySelector(".bar-filter-menu-320-wrapper"),{bottom:l}=t.getBoundingClientRect(),s=document.documentElement.clientHeight;this.isFilterMenu320Open=l+s<s&&"none"!==window.getComputedStyle(e).display},handleFilterBtnClick(){const{getScrollTarget:t,setScrollPosition:e}=qa.ZP,l=this.$el.querySelector(".bar-filter-menu-320-wrapper"),s=l.offsetTop,a=t(l);e(a,s,0)},showFilter(){this.isFilterOpen=!0},openNotice(){this.notice=!0},setTreasuryBar:function(t){$a.log("ActionBar.setTreasuryBar()",t),this.treasuryBar=t},setFilterParams(t){"amend-ballots"===t?(this.typeGroup=[],this.submitTypesResult=[],this.statusGroup=["active"],this.submitStatusesResult=["active"]):"worker-proposals"===t?(this.typeGroup=["proposal"],this.submitTypesResult=["proposal"],this.statusGroup=["active"],this.submitStatusesResult=["active"]):"t-f-election"===t?(this.typeGroup=["election"],this.submitTypesResult=["election"],this.statusGroup=["active"],this.submitStatusesResult=["active"]):"polls"===t&&(this.typeGroup=["poll"],this.submitTypesResult=["poll"],this.statusGroup=["active"],this.submitStatusesResult=["active"]),this.$emit("update-cards",{type:this.typeGroup,status:this.statusGroup,treasury:this.treasuryBar})}},mounted(){this.setFilterParams(this.activeFilter)},created(){window.addEventListener("scroll",this.handleScroll)},unmounted(){window.removeEventListener("scroll",this.handleScroll)},computed:{...(0,u.Se)("accounts",["isAuthenticated"]),typeOptions(){return this.$route.path.indexOf("election")>0?this.electionsPageTypeOptions:this.proposalsPageTypeOptions}},watch:{$route(t,e){void 0!==t.params.id?this.showBallot=!0:this.showBallot=!1},activeFilter:function(){this.setFilterParams(this.activeFilter)},treasuryBar:function(t,e){t!==e&&this.resetBallots(),this.$emit("update-treasury",this.treasuryBar)},submitStatusesResult:function(t,e){t!==e&&(this.statusGroup=this.submitStatusesResult,this.resetBallots(),this.$emit("update-statuses",this.submitStatusesResult))},submitTypesResult:function(t,e){t!==e&&(this.typeGroup=this.submitTypesResult,this.resetBallots(),this.$emit("update-categories",this.submitTypesResult))},treasuriesOptions:{immediate:!0,handler:async function(t){t.length||await this.fetchTreasuries()}},isBallotListRowDirection:function(t,e){t!==e&&this.$emit("change-diraction",this.isBallotListRowDirection)},sortMode:function(){this.$emit("change-sort-option",this.sortMode)}}};var Ma=l(66663),Ua=l(2286),za=l(8326),Za=l(1389),La=l(56362),Ra=l(67236),Aa=l(11819);const Pa=(0,v.Z)(Fa,[["render",Va]]),Qa=Pa;U()(Fa,"components",{QIcon:O.Z,QBtn:$.Z,QDialog:_.Z,QScrollArea:Ma.Z,QOptionGroup:Ua.Z,QForm:za.Z,QBtnToggle:Za.Z,QMenu:La.Z,QSeparator:me.Z,QCard:k.Z,QCardSection:S.Z,QCardActions:q.Z,QBtnGroup:Ra.Z,QColor:Aa.Z}),U()(Fa,"directives",{ClosePopup:F.Z});var Ia=l(17779);const Na={name:"BallotsList",components:{BallotForm:Z,BallotListItem:he,BallotView:ns,WelcomeCard:_s,ActionBar:Qa},data(){return{renderComponent:!1,show:!1,showBallot:!1,statusChange:!1,timeAtMount:void 0,openedBallot:{},voting:!1,treasury:"VOTE",statuses:[],categories:[],isBallotListRowDirection:!0,currentPage:1,page:1,sortMode:"",startY:0,timerAction:null,limit:100,maxLimit:500,loading:!1}},props:{activeFilter:{type:String}},async mounted(){this.timeAtMount=Date.now(),this.statusChange=!1,this.$route.params.id&&(this.showBallot=!0),this.$route.query&&this.$route.query.treasury&&(this.treasury=this.$route.query.treasury,this.$refs.actionBar&&this.$refs.actionBar.setTreasuryBar(this.treasury)),this.resetBallots(),await this.fetchFees(),this.$refs.infiniteScroll&&this.$refs.infiniteScroll.reset(),this.$refs.infiniteScroll&&this.$refs.infiniteScroll.poll()},created(){window.addEventListener("scroll",this.onLoad)},unmounted(){window.removeEventListener("scroll",this.onLoad)},methods:{...(0,u.nv)("trails",["fetchFees","fetchBallots","castVote","fetchTreasuries","fetchBallotsByStatus"]),...(0,u.OI)("trails",["resetBallots","stopAddBallots"]),async onLoad(t){let e=window.scrollY;if(this.loading=!0,e>this.startY&&this.limit<=this.maxLimit||!0===t){this.$refs.infiniteScroll&&this.$refs.infiniteScroll.resume(),!0===t?this.limit=300:this.limit+=100;const l={index:4,lower:this.treasury||this.$route.query&&this.$route.query.treasury,upper:this.treasury||this.$route.query&&this.$route.query.treasury,limit:this.limit};await this.fetchBallots(l),e===this.startY&&(this.$refs.infiniteScroll&&this.$refs.infiniteScroll.stop(),this.loading=!1)}else setTimeout((()=>{this.$refs.infiniteScroll&&this.$refs.infiniteScroll.stop(),this.loading=!1}),3e3);this.startY=e},openBallotForm(){this.show=!0},closeBallot(){this.showBallot=!1},openBallot(t){this.showBallot?this.showBallot=!1:(this.timeAtMount=Date.now(),this.$router.push(`/trails/${this.$route.path.indexOf("election")>0?"elections":"ballot"}/${t.ballot_name}/${this.timeAtMount}`))},getLocalTime(t){const e=60*(new Date).getTimezoneOffset()*1e3;return new Date(t).getTime()-e},isBallotOpened(t){let e=this.getLocalTime(t.end_time),l=e>Date.now(),s=this.getLocalTime(t.begin_time),a=s<Date.now();return l&&a},isBallotNotStarted(t){const e=this.getLocalTime(t.begin_time);return e>Date.now()},displayWinner(t){if(!t.total_voters)return!1;let e,l=-1;return t.options.forEach((t=>{parseFloat(t.value)>l&&(l=parseFloat(t.value),e=t.key)})),e},votingHasBegun(t){let e=new Date(t.begin_time).getTime(),l=e<Date.now();return l},getStartTime(t){return this.getLocalTime(t.begin_time)},getEndTime(t){return this.getLocalTime(t.end_time)},isNewUser(){return localStorage.isNewUser},updateTreasury(t){this.limit=100,this.treasury=t,this.onLoad(!0)},updateStatuses(t){this.limit=100,this.statuses=t,this.onLoad(!0)},updateCategories(t){this.limit=100,this.categories=t,this.onLoad(!0)},filterBallots(t){const e=t.filter((t=>{if(this.statuses)return 0===this.statuses.length||(this.statuses.includes("active")&&this.statuses.includes("expired")?this.statuses.includes(t.status)||"voting"===t.status:this.statuses.includes("active")?Date.now()<Date.parse(t.end_time):this.statuses.includes("expired")?this.statuses.includes(t.status)||!this.isBallotOpened(t)&&this.votingHasBegun(t)&&"voting"===t.status:this.statuses.includes("not started")?this.statuses.includes(t.status)||this.isBallotNotStarted(t)&&"voting"===t.status:this.statuses.includes(t.status))})),l=e.filter((t=>this.categories.length>0?this.categories.includes(t.category):this.$route.path.indexOf("election")>0?["election","referendum","leaderboard"].includes(t.category):["poll","proposal"].includes(t.category))),s=l.filter((t=>{if(!this.treasury)return!0;try{return t.treasury_symbol.split(",")[1]==this.treasury}catch(e){Ia.log("Problematic ballot: ",t),Ia.error(e)}return!1}));return s},changeDirection(t){this.limit=100,this.isBallotListRowDirection=t,this.onLoad(!0)},getLoser(){return!(!this.ballot.total_voters||2!==this.ballot.options.length)&&this.ballot.options.find((t=>t.key!==this.getWinner.key))},sortBallots(t,e){return"A-Z"===e?t.sort(((t,e)=>t.title.toLowerCase()>e.title.toLowerCase()?1:-1)):"Z-A"===e?t.sort(((t,e)=>t.title.toLowerCase()<e.title.toLowerCase()?1:-1)):"Most popular"===e?t.sort(((t,e)=>t.total_voters<e.total_voters?1:-1)):"Least popular"===e?t.sort(((t,e)=>t.total_voters>e.total_voters?1:-1)):""===e?t:void 0},changeSortOption(t){this.limit=100,this.sortMode=t,this.onLoad(!0)},ballotContentImg(t){try{return JSON.parse(t.content).imageUrl}catch(e){return null}},updateCards(t){this.treasury=t.treasury,this.statuses=t.tatus,this.categories=t.type}},computed:{...(0,u.Se)("accounts",["isAuthenticated"]),...(0,u.Se)("trails",["ballots","ballotsLoaded","treasuriesOptions"])},watch:{$route(t,e){this.showBallot=!!t.params.id,t.params.id||this.showBallot||(this.renderComponent=!0,this.$nextTick((()=>{this.renderComponent=!1,this.onLoad(!0)})))}}};var Ha=l(69885),Ga=l(47501);const Ea=(0,v.Z)(Na,[["render",r],["__scopeId","data-v-65abe7c9"]]),ja=Ea;U()(Na,"components",{QPage:Ha.Z,QInfiniteScroll:ge.Z,QSpinnerDots:Ga.Z,QDialog:_.Z,QBtn:$.Z}),U()(Na,"directives",{ClosePopup:F.Z})},7420:()=>{},95856:()=>{},35883:()=>{},52596:()=>{},63897:()=>{},79156:()=>{},62678:()=>{},25819:()=>{},52361:()=>{},94616:()=>{}}]);