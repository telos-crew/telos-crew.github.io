"use strict";(globalThis["webpackChunkapp_telos_net"]=globalThis["webpackChunkapp_telos_net"]||[]).push([[672],{16672:(e,o,t)=>{t.r(o),t.d(o,{default:()=>S});var s=t(59835);const a=(0,s._)("div",{class:"q-pa-sm"},null,-1);function l(e,o,t,l,n,r){const p=(0,s.up)("q-btn-toggle"),i=(0,s.up)("ExpansionProposal"),c=(0,s.up)("q-list"),u=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(u,{class:"q-pa-lg"},{default:(0,s.w5)((()=>[a,(0,s.Wm)(p,{modelValue:n.type,"onUpdate:modelValue":o[0]||(o[0]=e=>n.type=e),push:"","toggle-color":"primary",color:"white","text-color":"primary",options:[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}]},null,8,["modelValue"]),(0,s.Wm)(c,{class:"rounded-borders",bordered:""},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.ProposalsPage,(e=>((0,s.wg)(),(0,s.j4)(i,{proposal:e,key:e.proposal_name},null,8,["proposal"])))),128))])),_:1})])),_:1})}var n=t(33100),r=t(86970);const p={class:"absolute-full flex flex-center"},i=["src"];function c(e,o,t,a,l,n){const c=(0,s.up)("q-avatar"),u=(0,s.up)("q-item-section"),d=(0,s.up)("q-item-label"),m=(0,s.up)("q-badge"),h=(0,s.up)("q-linear-progress"),w=(0,s.up)("q-card-section"),f=(0,s.up)("q-card"),g=(0,s.up)("q-expansion-item");return(0,s.wg)(),(0,s.j4)(g,{key:t.proposal.ballot_name,label:t.proposal.title,caption:t.proposal.description,group:"ProposalsPage.vue",onBeforeShow:n.onShow},{header:(0,s.w5)((()=>[(0,s.Wm)(u,{avatar:""},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{icon:l.icon,color:l.iconColor,"text-color":"white","font-size":".75em"},null,8,["icon","color"])])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,r.zw)(t.proposal.title),1)])),_:1}),(0,s.Wm)(d,{caption:""},{default:(0,s.w5)((()=>[(0,s.Uk)((0,r.zw)(t.proposal.description),1)])),_:1})])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Milestone "+(0,r.zw)(t.proposal.current_milestone)+" of "+(0,r.zw)(t.proposal.milestones),1),(0,s._)("div",null,["inprogress"==t.proposal.status||"passed"==t.proposal.status||"failed"==t.proposal.status?((0,s.wg)(),(0,s.j4)(h,{key:0,value:l.yesVotes,color:"positive","track-color":"negative",rounded:"",size:"35px"},{default:(0,s.w5)((()=>[(0,s._)("div",p,[(0,s.Wm)(m,{color:"white","text-color":"primary",label:`${(100*l.yesVotes).toFixed(2)}% YES`},null,8,["label"])])])),_:1},8,["value"])):(0,s.kq)("",!0)])])),_:1})])),default:(0,s.w5)((()=>[(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Proposer: "+(0,r.zw)(t.proposal.proposer),1)])),_:1}),(0,s.Wm)(d,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Category: "+(0,r.zw)(t.proposal.category),1)])),_:1})])),_:1}),(0,s.Wm)(u,{class:"q-pa-md"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,r.zw)(l.contentText),1)])),_:1}),l.contentUrl?((0,s.wg)(),(0,s.iD)("iframe",{key:0,src:l.contentUrl,width:"100%",height:"600px"},null,8,i)):(0,s.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["label","caption","onBeforeShow"])}t(18964);const u=new RegExp(/Qm[1-9A-HJ-NP-Za-km-z]{44}(\/.*)?/,"m"),d=new RegExp(/\/ipfs\/Qm[1-9A-HJ-NP-Za-km-z]{44}(\/.*)?/,"m"),m=new RegExp(/https?\:\/\/.*\/ipfs\/Qm[1-9A-HJ-NP-Za-km-z]{44}(\/.*)?/,"m"),h="https://ipfs.telos.miami/ipfs/",w={name:"ExpansionProposal",props:{proposal:Object},computed:{...(0,n.Se)("accounts",["isAuthenticated","account"])},data(){return{icon:null,iconColor:null,contentUrl:null,contentText:null,haveVoted:null,yesVotes:0,vote:null}},beforeMount(){this.setIcon(),this.setYesVotes(),this.findContent()},methods:{setYesVotes(){const e=this.proposal.ballotData.options,o=parseFloat(e[2].value.split(" ")[0]),t=parseFloat(e[1].value.split(" ")[0]);this.yesVotes=o/(o+t)},findContent(){let e,o=this.proposal.content;o.match(u)&&(e=h+u.exec(o)[0],o=o.replace(m,"").replace(d,"").replace(u,"")),this.contentText=o,e&&(this.contentUrl=e)},setIcon(){switch(this.proposal.category){case"marketing":this.icon="campaign",this.iconColor="positive";break;case"apps":this.icon="web",this.iconColor="primary";break;case"developers":this.icon="code",this.iconColor="accent";break;case"education":this.icon="school",this.iconColor="negative";break}},async onShow(){if(!this.isAuthenticated)return;const e=await this.$api.getTableRows({code:"telos.decide",scope:this.proposal.proposal_name,table:"votes",lower_bound:this.account,upper_bound:this.account});e.rows&&(this.haveVoted=!0,this.vote=e.rows[0])}}};var f=t(11639),g=t(50651),v=t(76749),b=t(61357),k=t(33115),_=t(8289),x=t(20990),y=t(44458),W=t(63190),q=t(69984),Z=t.n(q);const P=(0,f.Z)(w,[["render",c]]),Q=P;Z()(w,"components",{QExpansionItem:g.Z,QItemSection:v.Z,QAvatar:b.Z,QItemLabel:k.Z,QLinearProgress:_.Z,QBadge:x.Z,QCard:y.Z,QCardSection:W.Z});const C={name:"ProposalsPage",components:{ExpansionProposal:Q},data(){return{type:"active"}},methods:{...(0,n.nv)("works",["fetchWorks"])},beforeMount(){this.fetchWorks()},computed:{proposals(){return this.$store.state.works[this.type]}}};var z=t(69885),U=t(1389),V=t(13246);const E=(0,f.Z)(C,[["render",l]]),S=E;Z()(C,"components",{QPage:z.Z,QBtnToggle:U.Z,QList:V.Z})}}]);