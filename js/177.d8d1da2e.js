"use strict";(globalThis["webpackChunkapp_telos_net"]=globalThis["webpackChunkapp_telos_net"]||[]).push([[177],{79177:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ae});var s=a(59835);function o(e,t,a,o,l,r){const i=(0,s.up)("q-btn"),n=(0,s.up)("ValidatorDataChart"),c=(0,s.up)("ValidatorDataTable");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(i,{class:"toggle",onClick:r.toggleView,label:r.toggleLabel,color:"primary"},null,8,["onClick","label"]),e.account?((0,s.wg)(),(0,s.j4)(i,{key:0,class:"toggle",onClick:r.castVote,disable:!l.voteChanged,label:"Vote",color:"primary"},null,8,["onClick","disable"])):(0,s.kq)("",!0),e.account?((0,s.wg)(),(0,s.j4)(i,{key:1,class:"toggle",onClick:r.resetVote,disable:!l.voteChanged,label:"Reset",color:"primary"},null,8,["onClick","disable"])):(0,s.kq)("",!0),l.showCpu?((0,s.wg)(),(0,s.j4)(n,{key:2})):((0,s.wg)(),(0,s.j4)(c,{key:3,ref:"ValidatorDataTable",producerData:l.producerData,producerVotes:l.producerVotes,lastWeight:l.lastWeight,lastStaked:l.lastStaked,stakedAmount:l.stakedAmount,lastUpdated:l.lastUpdated,onVoteChanged:r.toggleVoteButtons,onGetVotes:r.getVotes},null,8,["producerData","producerVotes","lastWeight","lastStaked","stakedAmount","lastUpdated","onVoteChanged","onGetVotes"]))])}var l=a(39981),r=a.n(l),i=a(33100);const n=(0,s.Uk)("Select all"),c=(0,s.Uk)("Deselect all");function d(e,t,a,o,l,r){const i=(0,s.up)("highcharts"),d=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(i,{options:l.chartOptions,updateArgs:[!0,!1],ref:"highcharts"},null,8,["options"]),(0,s.Wm)(d,{class:"q-pa-sm",onClick:t[0]||(t[0]=e=>r.toggleVisible(!0))},{default:(0,s.w5)((()=>[n])),_:1}),(0,s.Wm)(d,{class:"q-pa-sm",onClick:t[1]||(t[1]=e=>r.toggleVisible(!1))},{default:(0,s.w5)((()=>[c])),_:1})])}var u=a(15581);const h={name:"ValidatorDataChart",data(){return{chartOptions:{title:{text:"Validator CPU Performance"},credits:{enabled:!1},xAxis:{type:"datetime"},yAxis:{title:{text:"microseconds"}},legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"},chart:{height:"85%"}},benchmarkDays:1}},components:{highcharts:u.Chart},computed:{...(0,i.rn)("validators",["benchmarks"])},async mounted(){this.loadBenchmarks({days:this.benchmarkDays})},watch:{benchmarks(){this.$refs.highcharts.chart.series=[];for(let e=0;e<this.benchmarks.length;e++){let t=this.benchmarks[e];this.$refs.highcharts.chart.addSeries(t,e===this.benchmarks.length-1)}}},methods:{...(0,i.nv)("validators",["loadBenchmarks"]),toggleVisible(e){this.$refs.highcharts.chart.series.forEach((t=>{e?t.show():t.hide()}))}}};var p=a(11639),g=a(68879),m=a(69984),f=a.n(m);const k=(0,p.Z)(h,[["render",d]]),w=k;f()(h,"components",{QBtn:g.Z});var b=a(86970);const V={class:"q-pa-md"},y={key:0,class:"row items-start q-gutter-md"},v={class:"q-card-section"},_={class:"count-field"},C=(0,s.Uk)("Selected Validators:"),W={class:"count-field"},x=(0,s.Uk)("Projected Vote Weight:"),D={class:"count-field"},q=(0,s.Uk)("Last Vote Weight:"),z={class:"count-field"},j=(0,s.Uk)("Vote Weight Change:"),A=(0,s.Uk)("* = testnet, LPB = lifetime produced blocks, LMB = lifetime missed blocks"),T=["href"],U=["href"],S=["href"],$=["href"];function B(e,t,a,o,l,r){const i=(0,s.up)("q-icon"),n=(0,s.up)("q-card"),c=(0,s.up)("q-checkbox"),d=(0,s.up)("q-td"),u=(0,s.up)("q-tr"),h=(0,s.up)("q-table");return(0,s.wg)(),(0,s.iD)("div",V,[e.account?((0,s.wg)(),(0,s.iD)("div",y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.currentVote,((e,t)=>((0,s.wg)(),(0,s.j4)(n,{class:"producer-card"},{default:(0,s.w5)((()=>[(0,s._)("div",v,[(0,s.Uk)((0,b.zw)(e),1),(0,s.Wm)(i,{name:"fas fa-times",size:"xs",color:"primary",onClick:t=>r.removeVote(e)},null,8,["onClick"])])])),_:2},1024)))),256))])):(0,s.kq)("",!0),e.account?((0,s.wg)(),(0,s.j4)(n,{key:1,class:"voting-stats"},{default:(0,s.w5)((()=>[(0,s._)("div",_,[C,(0,s._)("span",{class:(0,b.C_)({"full-selection":r.maxSelected})},(0,b.zw)(l.currentVote.length)+" of 30",3)]),(0,s._)("div",W,[x,(0,s._)("span",{class:(0,b.C_)({"full-selection":r.maxSelected})},(0,b.zw)(r.projectedVoteWeight),3)]),(0,s._)("div",D,[q,(0,s._)("span",null,(0,b.zw)(a.lastWeight),1)]),(0,s._)("div",z,[j,(0,s._)("span",null,(0,b.zw)(r.weightChange),1)])])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(h,{title:r.tableHeader,pagination:l.pagination,rows:a.producerData,columns:l.producerColumns,"row-key":"__index"},{"top-right":(0,s.w5)((()=>[A])),default:(0,s.w5)((()=>[(0,s.Wm)(u,{slot:"body","slot-scope":"props",props:e.props},{default:(0,s.w5)((()=>[e.account?((0,s.wg)(),(0,s.j4)(d,{key:"selected"},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{modelValue:l.currentVote,"onUpdate:modelValue":t[0]||(t[0]=e=>l.currentVote=e),val:e.props.cols[2].value},null,8,["modelValue","val"])])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(d,{class:"vote-indicator",key:"number"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,b.zw)(e.props.cols[1].value),1)])),_:1}),(0,s.Wm)(d,{key:"owner"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,b.zw)(e.props.cols[2].value),1)])),_:1}),(0,s.Wm)(d,{class:"flag-column",key:"country"},{default:(0,s.w5)((()=>[(0,s._)("span",{class:(0,b.C_)(["flag-icon",r.getFlag(e.props.cols[3].value)])},null,2)])),_:1}),e.props.cols[4].value?((0,s.wg)(),(0,s.j4)(d,{class:"no-decoration",key:"social",align:"center"},{default:(0,s.w5)((()=>[e.props.cols[4].value.website?((0,s.wg)(),(0,s.iD)("a",{key:0,href:e.props.cols[4].value.website},[(0,s.Wm)(i,{name:"fas fa-globe",size:"xs",color:"primary"})],8,T)):(0,s.kq)("",!0),e.props.cols[4].value.social.twitter?((0,s.wg)(),(0,s.iD)("a",{key:1,href:r.getLink("twitter.com",e.props.cols[4].value.social.twitter)},[(0,s.Wm)(i,{name:"fab fa-twitter",size:"xs",color:"primary"})],8,U)):(0,s.kq)("",!0),e.props.cols[4].value.social.github?((0,s.wg)(),(0,s.iD)("a",{key:2,href:r.getLink("github.com",e.props.cols[4].value.social.github)},[(0,s.Wm)(i,{name:"fab fa-github",size:"xs",color:"primary"})],8,S)):(0,s.kq)("",!0),e.props.cols[4].value.social.telegram?((0,s.wg)(),(0,s.iD)("a",{key:3,href:r.getLink("t.me",e.props.cols[4].value.social.telegram)},[(0,s.Wm)(i,{name:"fab fa-telegram",size:"xs",color:"primary"})],8,$)):(0,s.kq)("",!0)])),_:1})):((0,s.wg)(),(0,s.j4)(d,{key:"social-none"})),(0,s.Wm)(d,{key:"votes",align:"right"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,b.zw)(e.props.cols[5].value),1)])),_:1}),(0,s.Wm)(d,{key:"sslVerified",align:"left"},{default:(0,s.w5)((()=>[!0===e.props.cols[6].value?((0,s.wg)(),(0,s.j4)(i,{key:0,name:"fas fa-check",size:"xs",color:"green"})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"fas fa-times",size:"xs",color:"red"}))])),_:1}),(0,s.Wm)(d,{key:"apiVerified",align:"left"},{default:(0,s.w5)((()=>[!0===e.props.cols[7].value?((0,s.wg)(),(0,s.j4)(i,{key:0,name:"fas fa-check",size:"xs",color:"green"})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"fas fa-times",size:"xs",color:"red"}))])),_:1}),(0,s.Wm)(d,{key:"sslVerifiedTestNet",align:"left"},{default:(0,s.w5)((()=>[!0===e.props.cols[8].value?((0,s.wg)(),(0,s.j4)(i,{key:0,name:"fas fa-check",size:"xs",color:"green"})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"fas fa-times",size:"xs",color:"red"}))])),_:1}),(0,s.Wm)(d,{key:"apiVerifiedTestNet",align:"left"},{default:(0,s.w5)((()=>[!0===e.props.cols[9].value?((0,s.wg)(),(0,s.j4)(i,{key:0,name:"fas fa-check",size:"xs",color:"green"})):((0,s.wg)(),(0,s.j4)(i,{key:1,name:"fas fa-times",size:"xs",color:"red"}))])),_:1}),(0,s.Wm)(d,{key:"lifetimeProducedBlocks",align:"right"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,b.zw)(e.props.cols[10].value),1)])),_:1}),(0,s.Wm)(d,{key:"lifetimeMissedBlocks",align:"right"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,b.zw)(e.props.cols[11].value),1)])),_:1}),(0,s.Wm)(d,{key:"missedBlocksPer",align:"left"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,b.zw)(e.props.cols[12].value),1)])),_:1})])),_:1},8,["props"])])),_:1},8,["title","pagination","rows","columns"])])}a(40702);var L=a(43878),P=a.n(L),F=a(44585),N=a(17779);const I=30,Z={name:"ValidatorDataTable",props:{producerVotes:{type:Array,required:!0},producerData:{type:Array,required:!0},lastWeight:{type:String,required:!0},lastStaked:{type:Number,required:!0},stakedAmount:{type:Number,required:!0},lastUpdated:{type:String,required:!0}},data(){return{currentVote:[],pagination:{rowsPerPage:21},producerColumns:[{name:"selected",label:"",align:"left",sortable:!1,headerClasses:"selected-column"},{name:"number",label:"#",field:e=>this.producerData.indexOf(e)+1,align:"left",sortable:!0},{name:"owner",label:"Block Producer",field:"owner",align:"left",sortable:!0},{name:"country",label:"Country",field:e=>this.getCountry(e.location),align:"center",sortable:!0},{name:"social",label:"Links",field:e=>e.org,align:"center"},{name:"votes",label:"Total Votes",field:e=>(e.total_votes/1e4).toFixed(0),align:"right",sortable:!0,sort:(e,t,a,s)=>parseInt(e,10)-parseInt(t,10)},{name:"sslVerified",label:"SSL",field:e=>!0===e.sslVerified,align:"left",sortable:!0},{name:"apiVerified",label:"API",field:e=>!0===e.apiVerified,align:"left",sortable:!0},{name:"sslVerifiedTestNet",label:"SSL*",field:e=>!0===e.sslVerifiedTestNet,align:"left",sortable:!0},{name:"apiVerifiedTestNet",label:"API*",field:e=>!0===e.apiVerifiedTestNet,align:"left",sortable:!0},{name:"lifetimeProducedBlocks",label:"LPB",field:"lifetime_produced_blocks",align:"center",sortable:!0,sort:(e,t,a,s)=>parseInt(e,10)-parseInt(t,10)},{name:"lifetimeMissedBlocks",label:"LMB",field:"lifetime_missed_blocks",align:"center",sortable:!0,sort:(e,t,a,s)=>parseInt(e,10)-parseInt(t,10)},{name:"missedBlocksPer",label:"LMB(%)",field:e=>0===e.lifetime_produced_blocks?0===e.lifetime_missed_blocks?"N/A":100:(100*parseFloat(e.lifetime_missed_blocks/e.lifetime_produced_blocks)).toFixed(3),align:"left",sortable:!0,sort:(e,t,a,s)=>parseFloat(e,10)-parseFloat(t,10)}]}},mounted(){this.checkHeader(),this.resetVotes()},watch:{producerVotes(e){this.$emit("vote-changed",!1),0===this.currentVote.length&&(this.currentVote=[...e])},currentVote(e){if(e.length>I)return this.currentVote.pop(),void alert("You can only vote for 30 validators.");this.areEqualArrays(e,this.producerVotes)?this.$emit("vote-changed",!1):this.$emit("vote-changed",!0)},account(){this.checkHeader()}},computed:{...(0,i.Se)("accounts",["account"]),tableHeader(){const e=P().utc(this.lastUpdated).local().format("YYYY-MM-DD HH:mm");return`Validators (${e})`},maxSelected(){return this.currentVote.length===I},projectedVoteWeight(){if(0===this.currentVote.length)return 0;const e=this.currentVote.length/I,t=(Math.sin(Math.PI*e-Math.PI/2)+1)/2;return parseFloat(t*this.stakedAmount).toFixed(2)},weightChange(){const e=(this.projectedVoteWeight-this.lastWeight).toFixed(2),t=e>0?"+":"",a=this.lastWeight>.001?(this.projectedVoteWeight/this.lastWeight*100).toFixed(2):(100*this.projectedVoteWeight).toFixed(2);return`${t}${e} (${a}%)`}},methods:{removeVote(e){this.currentVote.splice(e,1)},getLink(e,t){return`https://${e}/${t}`},getCountry(e){var t;const a=null!==(t=F.whereNumeric(e))&&void 0!==t?t:{alpha2:""};return a.alpha2.toLowerCase()},getFlag(e){return e?`flag-icon-${e}`:""},checkHeader(){const e=document.getElementsByClassName("selected-column")[0];e.style.height="48px",this.account?e.style.display="block":e.style.display="none"},areEqualArrays(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var a=e.concat().sort(),s=t.concat().sort(),o=0;o<a.length;o++)if(a[o]!==s[o])return!1;return!0},resetVotes(){this.currentVote=[...this.producerVotes]},async sendVoteTransaction(){this.currentVote.sort();const e=[{account:"eosio",name:"voteproducer",data:{voter:this.account,proxy:"",producers:[...this.currentVote]}}];try{await this.$store.$api.signTransaction(e),this.$emit("get-votes")}catch(t){N.error(t)}}}};var M=a(44458),Q=a(63190),H=a(22857),E=a(45950),Y=a(31233),O=a(67220),G=a(11221);const K=(0,p.Z)(Z,[["render",B],["__scopeId","data-v-9e196ea0"]]),R=K;f()(Z,"components",{QCard:M.Z,QCardSection:Q.Z,QIcon:H.Z,QTable:E.Z,QTr:Y.Z,QTd:O.Z,QCheckbox:G.Z});var J=a(17779);const X="https://telos-producer-validation.s3.amazonaws.com",ee={name:"Validator",components:{ValidatorDataChart:w,ValidatorDataTable:R},data(){return{lastUpdated:"",producerData:[],producerVotes:[],showCpu:!1,voteChanged:!1,resetFlag:!1,lastWeight:"0",lastStaked:0,stakedAmount:0}},async mounted(){await this.getData()},computed:{...(0,i.Se)("accounts",["account"]),toggleLabel(){return this.showCpu?"View Table":"View Graph"}},methods:{async getData(){try{const e=await r().get(X),t=this.getLastKey(e);this.producerData=["test"],this.producerData=(await r().get(`${X}/${t}`)).data,await this.getVotes()}catch(e){J.log("Error",e)}},getLastKey(e){const t=new DOMParser,a=t.parseFromString(e.data,"text/xml").getElementsByTagName("Contents"),s=a[a.length-1];return this.lastUpdated=s.childNodes[1].textContent,s.childNodes[0].textContent},async getVotes(){if(this.account){const e=(await this.$store.$api.getAccount(this.account)).voter_info;this.producerVotes=e.producers,this.lastWeight=parseFloat(e.last_vote_weight).toFixed(2),this.lastStaked=e.last_stake,this.stakedAmount=e.staked}},toggleView(){this.showCpu=!this.showCpu},castVote(e){this.$refs.ValidatorDataTable.sendVoteTransaction()},resetVote(e){this.$refs.ValidatorDataTable.resetVotes()},toggleVoteButtons(e){this.voteChanged=e}}},te=(0,p.Z)(ee,[["render",o]]),ae=te;f()(ee,"components",{QBtn:g.Z})}}]);